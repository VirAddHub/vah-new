"use strict";(()=>{var e={};e.id=317,e.ids=[317],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4822:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>j,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>x,staticGenerationAsyncStorage:()=>N});var s={};a.r(s),a.d(s,{DELETE:()=>d,GET:()=>m,PUT:()=>u});var n=a(9303),r=a(8716),o=a(670),i=a(7070);async function u(e,{params:t}){try{let a=t.id,s=await e.json(),{firstName:n,lastName:r,email:o,phone:u,companyName:m,businessType:d,companyNumber:y,vatNumber:f,address:h,plan:N,role:x,is_admin:j,status:v,kyc_status:w}=s;if(!n||!r||!o||!m)return i.NextResponse.json({error:"Missing required fields"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o))return i.NextResponse.json({error:"Invalid email format"},{status:400});let S=await l(a);if(!S)return i.NextResponse.json({error:"User not found"},{status:404});if(o!==S.email&&await p(o,a))return i.NextResponse.json({error:"Email already exists for another user"},{status:409});let A={...S,firstName:n.trim(),lastName:r.trim(),name:`${n.trim()} ${r.trim()}`,email:o.trim().toLowerCase(),phone:u?.trim()||"",companyName:m.trim(),businessType:d?.trim()||"",companyNumber:y?.trim()||"",vatNumber:f?.trim()||"",address:h||{},plan:N||"basic",role:x||"user",is_admin:j||!1,status:v||"active",kyc_status:w||"pending",updated_at:new Date().toISOString()},R=await c(a,A);return await g("user_updated",{userId:a,email:R.email,companyName:R.companyName,plan:R.plan,changes:s,updatedBy:"admin"}),i.NextResponse.json({user:R,message:"User updated successfully",timestamp:new Date().toISOString()})}catch(e){return console.error("User update error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e,{params:t}){try{let e=t.id,a=await l(e);if(!a)return i.NextResponse.json({error:"User not found"},{status:404});return i.NextResponse.json({user:a})}catch(e){return console.error("Get user error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e,{params:t}){try{let e=t.id,a=await l(e);if(!a)return i.NextResponse.json({error:"User not found"},{status:404});return await y(e),await g("user_deleted",{userId:e,email:a.email,companyName:a.companyName,deletedBy:"admin"}),i.NextResponse.json({message:"User deleted successfully",timestamp:new Date().toISOString()})}catch(e){return console.error("User deletion error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function l(e){return[{id:1,name:"Jane Doe",email:"jane@example.com",firstName:"Jane",lastName:"Doe",kyc:"approved",plan:"premium",status:"active",is_admin:!1,joined:"2023-08-15",lastLogin:"2 hours ago",mailCount:23,totalSpent:"\xa3299.88",companyName:"Doe Enterprises Ltd",address:{line1:"123 Business St",city:"London",postcode:"SW1A 1AA"},phone:"+44 20 7123 4567"},{id:2,name:"John Smith",email:"john@example.com",firstName:"John",lastName:"Smith",kyc:"pending",plan:"basic",status:"active",is_admin:!1,joined:"2023-09-02",lastLogin:"1 day ago",mailCount:8,totalSpent:"\xa339.99",companyName:"Smith Consulting",address:{line1:"456 High St",city:"Manchester",postcode:"M1 1AA"},phone:"+44 161 234 5678"},{id:3,name:"Alice Johnson",email:"alice@example.com",firstName:"Alice",lastName:"Johnson",kyc:"approved",plan:"professional",status:"suspended",is_admin:!1,joined:"2023-07-20",lastLogin:"5 days ago",mailCount:156,totalSpent:"\xa31,247.50",companyName:"Johnson & Associates",address:{line1:"789 Corporate Ave",city:"Birmingham",postcode:"B1 1AA"},phone:"+44 121 345 6789"}].find(t=>t.id.toString()===e)||null}async function p(e,t){return["admin@virtualaddresshub.co.uk","demo@virtualaddresshub.co.uk","jane@example.com","john@example.com","alice@example.com"].includes(e.toLowerCase())}async function c(e,t){return console.log("Updating user in database:",e,t),await new Promise(e=>setTimeout(e,100)),t}async function y(e){console.log("Soft deleting user:",e),await new Promise(e=>setTimeout(e,100))}async function g(e,t){try{console.log("Admin action logged:",{action:e,data:t,timestamp:new Date().toISOString(),ip:"127.0.0.1",userAgent:"Admin Panel"})}catch(e){console.error("Failed to log admin action:",e)}}let f=new n.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/admin/users/[id]/route",pathname:"/api/admin/users/[id]",filename:"route",bundlePath:"app/api/admin/users/[id]/route"},resolvedPagePath:"/Users/libanadan/Desktop/final_frontend/app/api/admin/users/[id]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:N,serverHooks:x}=f,j="/api/admin/users/[id]/route";function v(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:N})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[276,972],()=>a(4822));module.exports=s})();