(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{4756:function(e,s,a){Promise.resolve().then(a.bind(a,4312))},4312:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return sd}});var t=a(7437),i=a(2265),r=a(7053),n=a(535),l=a(1994),d=a(3335);function c(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,d.m6)((0,l.W)(s))}let o=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),m=i.forwardRef((e,s)=>{let{className:a,variant:i,size:n,asChild:l=!1,...d}=e,m=l?r.g7:"button";return(0,t.jsx)(m,{className:c(o({variant:i,size:n,className:a})),ref:s,...d})});m.displayName="Button";let h=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",a),...i})});h.displayName="Card";let x=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:c("flex flex-col space-y-1.5 p-6",a),...i})});x.displayName="CardHeader";let u=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("h3",{ref:s,className:c("text-2xl font-semibold leading-none tracking-tight",a),...i})});u.displayName="CardTitle",i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("p",{ref:s,className:c("text-sm text-muted-foreground",a),...i})}).displayName="CardDescription";let j=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:c("p-6 pt-0",a),...i})});j.displayName="CardContent",i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:c("flex items-center p-6 pt-0",a),...i})}).displayName="CardFooter";let p=i.forwardRef((e,s)=>{let{className:a,type:i,...r}=e;return(0,t.jsx)("input",{type:i,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...r})});p.displayName="Input";var g=a(6394);let f=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),v=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(g.f,{ref:s,className:c(f(),a),...i})});v.displayName=g.f.displayName;let N=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),y=i.forwardRef((e,s)=>{let{className:a,variant:i,...r}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:c(N({variant:i}),a),...r})});y.displayName="Alert",i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("h5",{ref:s,className:c("mb-1 font-medium leading-none tracking-tight",a),...i})}).displayName="AlertTitle";let w=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:c("text-sm [&_p]:leading-relaxed",a),...i})});w.displayName="AlertDescription";var b=a(8906),_=a(3639),k=a(5302),C=a(6337),S=a(7769),A=a(2208),L=a(2636),Z=a(2660);class P{setToken(e){this.token=e,localStorage.setItem("auth_token",e)}clearToken(){this.token=null,localStorage.removeItem("auth_token")}getHeaders(){let e={"Content-Type":"application/json"};return this.token&&(e.Authorization="Bearer ".concat(this.token)),e}async get(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch("".concat(this.baseUrl).concat(e),{method:"GET",headers:this.getHeaders(),...s});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return a.json()}async post(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=await fetch("".concat(this.baseUrl).concat(e),{method:"POST",headers:this.getHeaders(),body:s?JSON.stringify(s):void 0,...a});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return t.json()}async put(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=await fetch("".concat(this.baseUrl).concat(e),{method:"PUT",headers:this.getHeaders(),body:s?JSON.stringify(s):void 0,...a});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return t.json()}async delete(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch("".concat(this.baseUrl).concat(e),{method:"DELETE",headers:this.getHeaders(),...s});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return a.json()}constructor(e="/api"){this.token=null,this.baseUrl=e,this.token=localStorage.getItem("auth_token")}}let I=new P;class T{isAuthenticated(){return!!this.token}isAdmin(){var e;return(null===(e=this.user)||void 0===e?void 0:e.is_admin)||!1}getUser(){return this.user}setUser(e){this.user=e,localStorage.setItem("user",JSON.stringify(e))}setToken(e){this.token=e,localStorage.setItem("auth_token",e)}clearAuth(){this.token=null,this.user=null,localStorage.removeItem("auth_token"),localStorage.removeItem("user")}async checkAuth(){try{let e=await I.get("/api/auth/whoami");return this.setUser(e.user),e.user}catch(e){throw this.clearAuth(),e}}constructor(){this.token=null,this.user=null,this.token=localStorage.getItem("auth_token"),this.user=JSON.parse(localStorage.getItem("user")||"null")}}let F=new T;async function R(e,s){try{var a;await I.post("/api/audit/admin-action",{action:e,data:s,timestamp:new Date().toISOString(),adminId:null===(a=F.getUser())||void 0===a?void 0:a.id})}catch(e){console.error("Failed to log admin action:",e)}}async function U(e,s){try{var a;await I.post("/api/audit/auth-event",{event:e,data:s,timestamp:new Date().toISOString(),userId:null===(a=F.getUser())||void 0===a?void 0:a.id})}catch(e){console.error("Failed to log auth event:",e)}}function z(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function E(e){let[s,a]=(0,i.useState)(null),[t,r]=(0,i.useState)(!0),[n,l]=(0,i.useState)(null),d=async()=>{try{r(!0),l(null);let s=await I.get(e);a(s)}catch(e){l(e)}finally{r(!1)}};return(0,i.useEffect)(()=>{d()},[e]),{data:s,isLoading:t,error:n,refetch:()=>{d()}}}function D(e){let{onLogin:s,onGoBack:a}=e,[r,n]=(0,i.useState)(""),[l,d]=(0,i.useState)(""),[c,o]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1),[N,P]=(0,i.useState)(""),[T,z]=(0,i.useState)(""),[E,D]=(0,i.useState)(!1),[M,V]=(0,i.useState)(""),[q,G]=(0,i.useState)(!1),[O,B]=(0,i.useState)(0),[J,H]=(0,i.useState)(!1),[K,Y]=(0,i.useState)(0);(0,i.useEffect)(()=>{let e=localStorage.getItem("admin_lockout");if(e){let{attempts:s,timestamp:a}=JSON.parse(e),t=Date.now();t-a<9e5?(B(s),H(!0),Y(Math.ceil((9e5-(t-a))/1e3))):localStorage.removeItem("admin_lockout")}},[]),(0,i.useEffect)(()=>{if(J&&K>0){let e=setTimeout(()=>{Y(K-1)},1e3);return()=>clearTimeout(e)}J&&0===K&&(H(!1),B(0),localStorage.removeItem("admin_lockout"))},[J,K]);let W=async e=>{if(e.preventDefault(),P(""),z(""),!r||!l){P("Please enter both email and password");return}if(J){P("Account temporarily locked. Please wait ".concat(K," seconds before trying again."));return}f(!0);try{var a;await U("admin_login_attempt",{email:r});let e=await I.post("/api/auth/login",{email:r,password:l,isAdmin:!0});if(e.ok&&(null===(a=e.user)||void 0===a?void 0:a.is_admin))F.setToken(e.token),F.setUser(e.user),await U("admin_login_success",{email:r,adminId:e.user.id}),await R("admin_login",{email:r,adminId:e.user.id,loginTime:new Date().toISOString()}),localStorage.removeItem("admin_lockout"),B(0),z("Login successful! Redirecting..."),setTimeout(()=>{s()},1e3);else throw Error("Admin access required")}catch(s){let e=O+1;if(B(e),await U("admin_login_failed",{email:r,error:s.message,attempts:e}),e>=5)H(!0),Y(900),localStorage.setItem("admin_lockout",JSON.stringify({attempts:e,timestamp:Date.now()})),P("Too many failed attempts. Account locked for 15 minutes.");else{let a=s.message||"Invalid admin credentials";P("".concat(a," (").concat(5-e," attempts remaining)"))}}finally{f(!1)}},$=async e=>{if(e.preventDefault(),P(""),z(""),!M){P("Please enter your admin email address");return}G(!0);try{await U("admin_password_reset_request",{email:M}),await I.post("/api/admin/password-reset",{email:M}),await R("admin_password_reset_request",{email:M}),z("Password reset link sent to your email"),D(!1),V("")}catch(e){await U("admin_password_reset_failed",{email:M,error:e.message}),P(e.message||"Failed to send password reset link")}finally{G(!1)}},Q=async()=>{f(!0),P("");try{await U("admin_demo_login");let e={id:"demo-admin",email:"admin@virtualaddresshub.co.uk",name:"Demo Admin",is_admin:!0,role:"super_admin"};F.setUser(e),F.setToken("demo-admin-token"),await R("admin_demo_login",{demoUser:e.email,loginTime:new Date().toISOString()}),z("Demo admin session created! Redirecting..."),setTimeout(()=>{s()},1e3)}catch(e){P("Failed to create demo session")}finally{f(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-6",children:[(0,t.jsx)(b.Z,{className:"h-8 w-8 text-primary"}),(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"Admin Portal"})]}),(0,t.jsx)("h2",{className:"text-xl font-medium mb-2",children:"Administrator Access"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Sign in to access the admin dashboard"})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"h-5 w-5"}),"Admin Sign In"]})}),(0,t.jsxs)(j,{children:[N&&(0,t.jsxs)(y,{className:"mb-4",variant:"destructive",children:[(0,t.jsx)(_.Z,{className:"h-4 w-4"}),(0,t.jsx)(w,{children:N})]}),T&&(0,t.jsxs)(y,{className:"mb-4",children:[(0,t.jsx)(k.Z,{className:"h-4 w-4"}),(0,t.jsx)(w,{children:T})]}),J&&(0,t.jsxs)(y,{className:"mb-4",variant:"destructive",children:[(0,t.jsx)(C.Z,{className:"h-4 w-4"}),(0,t.jsxs)(w,{children:["Account locked due to too many failed attempts. Please wait ","".concat(Math.floor(K/60),":").concat((K%60).toString().padStart(2,"0"))," before trying again."]})]}),E?(0,t.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"resetEmail",children:"Admin Email"}),(0,t.jsx)(p,{id:"resetEmail",type:"email",value:M,onChange:e=>V(e.target.value),placeholder:"admin@virtualaddresshub.co.uk",required:!0})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(m,{type:"submit",className:"flex-1",disabled:q,children:q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):"Send Reset Link"}),(0,t.jsx)(m,{type:"button",variant:"outline",onClick:()=>D(!1),children:"Cancel"})]})]}):(0,t.jsxs)("form",{onSubmit:W,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"email",children:"Admin Email"}),(0,t.jsx)(p,{id:"email",type:"email",value:r,onChange:e=>n(e.target.value),placeholder:"admin@virtualaddresshub.co.uk",disabled:J,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"password",children:"Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(p,{id:"password",type:c?"text":"password",value:l,onChange:e=>d(e.target.value),className:"pr-10",disabled:J,required:!0}),(0,t.jsx)("button",{type:"button",onClick:()=>o(!c),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",disabled:J,children:c?(0,t.jsx)(S.Z,{className:"h-4 w-4"}):(0,t.jsx)(A.Z,{className:"h-4 w-4"})})]})]}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(m,{type:"button",variant:"link",size:"sm",onClick:()=>D(!0),disabled:J,children:"Forgot password?"})}),(0,t.jsx)(m,{type:"submit",className:"w-full",disabled:g||J,children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Signing in..."]}):"Access Admin Panel"})]})]})]}),(0,t.jsx)("div",{className:"mt-6 text-center",children:(0,t.jsxs)(m,{variant:"outline",size:"sm",onClick:a||(()=>window.history.back()),children:[(0,t.jsx)(Z.Z,{className:"h-4 w-4 mr-2"}),"Back to website"]})}),(0,t.jsxs)("div",{className:"mt-6 p-4 bg-card rounded-lg border",children:[(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Demo Access"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Use demo credentials for testing purposes"}),(0,t.jsx)(m,{variant:"outline",size:"sm",onClick:Q,disabled:g,className:"w-full",children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Demo Session..."]}):"Login as Demo Admin"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Demo admin credentials:"}),(0,t.jsx)("p",{className:"text-xs font-mono",children:"Email: admin@virtualaddresshub.co.uk"}),(0,t.jsx)("p",{className:"text-xs font-mono",children:"Password: admin123"})]})]}),(0,t.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(_.Z,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),(0,t.jsxs)("div",{className:"text-xs text-yellow-800",children:[(0,t.jsx)("p",{className:"font-medium",children:"Security Notice"}),(0,t.jsx)("p",{children:"Admin access is logged and monitored. Unauthorized access attempts will be reported."})]})]})})]})})}var M=a(6221),V=a(5805),q=a(9345),G=a(340),O=a(8226),B=a(8664),J=a(8728),H=a(2252),K=a(2489),Y=a(8293),W=a(2735),$=a(7692);function Q(e){let{size:s="md",showText:a=!0,className:i=""}=e;return(0,t.jsxs)("div",{className:"flex items-center gap-2 ".concat(i),children:[(0,t.jsx)("div",{className:"".concat({sm:"h-6 w-6",md:"h-8 w-8",lg:"h-12 w-12"}[s]," bg-primary rounded-lg flex items-center justify-center"),children:(0,t.jsx)("span",{className:"text-primary-foreground font-bold text-xs",children:"VAH"})}),a&&(0,t.jsx)("span",{className:"font-bold text-primary ".concat({sm:"text-sm",md:"text-lg",lg:"text-2xl"}[s]),children:"VirtualAddressHub"})]})}let X=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ee(e){let{className:s,variant:a,...i}=e;return(0,t.jsx)("div",{className:c(X({variant:a}),s),...i})}var es=a(9402),ea=a(5252),et=a(265),ei=a(5051),er=a(9663),en=a(4401),el=a(5131);function ed(){let[e,s]=(0,i.useState)(!1),[a,r]=(0,i.useState)(new Date),{data:n,isLoading:l,refetch:d}=E("/api/admin/stats"),{data:c,isLoading:o,refetch:p}=E("/api/admin/health"),{data:g,isLoading:f,refetch:v}=E("/api/admin/activity"),{data:N,isLoading:y,refetch:w}=E("/api/admin/pending"),b=async()=>{s(!0);try{await R("admin_overview_refresh"),await Promise.all([d(),p(),v(),w()]),r(new Date)}catch(e){await R("admin_overview_refresh_error",{error:e.message})}finally{s(!1)}},_=async()=>{try{await R("admin_view_all_activity"),window.open("/admin/activity","_blank")}catch(e){await R("admin_view_activity_error",{error:e.message})}},k=async(e,s)=>{try{await R("admin_pending_action",{actionType:e,actionId:s}),await I.post("/api/admin/pending/".concat(e,"/").concat(s,"/process")),w()}catch(a){await R("admin_pending_action_error",{actionType:e,actionId:s,error:a.message})}},C=n||{totalUsers:2847,monthlyRevenue:47329,mailProcessed:18492,activeForwards:1234,userGrowth:12.3,revenueGrowth:8.1,mailGrowth:23.4,forwardGrowth:-2.1};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Admin Overview"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Real-time system status and key performance metrics"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Last updated: ",a.toLocaleTimeString()]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(ee,{variant:"outline",className:"gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"System Operational"]}),(0,t.jsxs)(m,{variant:"outline",size:"sm",onClick:b,disabled:e,className:"gap-2",children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 ".concat(e?"animate-spin":"")}),"Refresh"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)(ec,{title:"Total Users",value:C.totalUsers.toLocaleString(),change:"+".concat(C.userGrowth,"%"),trend:"up",icon:(0,t.jsx)(es.Z,{className:"h-5 w-5 text-blue-500"}),loading:l}),(0,t.jsx)(ec,{title:"Monthly Revenue",value:"\xa3".concat(C.monthlyRevenue.toLocaleString()),change:"+".concat(C.revenueGrowth,"%"),trend:"up",icon:(0,t.jsx)(ea.Z,{className:"h-5 w-5 text-green-500"}),loading:l}),(0,t.jsx)(ec,{title:"Mail Processed",value:C.mailProcessed.toLocaleString(),change:"+".concat(C.mailGrowth,"%"),trend:"up",icon:(0,t.jsx)(q.Z,{className:"h-5 w-5 text-purple-500"}),loading:l}),(0,t.jsx)(ec,{title:"Active Forwards",value:C.activeForwards.toLocaleString(),change:"".concat(C.forwardGrowth>0?"+":"").concat(C.forwardGrowth,"%"),trend:C.forwardGrowth>0?"up":"down",icon:(0,t.jsx)(G.Z,{className:"h-5 w-5 text-orange-500"}),loading:l})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(h,{children:[(0,t.jsxs)(x,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(u,{className:"text-lg",children:"Recent Activity"}),(0,t.jsx)(m,{variant:"outline",size:"sm",onClick:_,children:"View All"})]}),(0,t.jsx)(j,{children:(0,t.jsx)("div",{className:"space-y-4",children:(g||[{icon:"UserCheck",title:"New user registration",description:"jane.doe@example.com verified KYC",time:"2 minutes ago"},{icon:"Mail",title:"Mail batch processed",description:"47 items scanned and uploaded",time:"15 minutes ago"},{icon:"Truck",title:"Forwarding completed",description:"Delivery #FR-2847 dispatched",time:"1 hour ago"},{icon:"CreditCard",title:"Payment processed",description:"Invoice #INV-1045 paid (\xa339.99)",time:"2 hours ago"}]).map((e,s)=>(0,t.jsx)(eo,{icon:e.icon,title:e.title,description:e.description,time:e.time},s))})})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{className:"text-lg",children:"System Health"})}),(0,t.jsx)(j,{children:(0,t.jsx)("div",{className:"space-y-4",children:(c||[{label:"Mail Processing API",status:"operational",uptime:"99.98%"},{label:"KYC Verification (Sumsub)",status:"operational",uptime:"99.95%"},{label:"Payment Gateway",status:"operational",uptime:"99.99%"},{label:"Database Performance",status:"warning",uptime:"97.82%"},{label:"Email Notifications",status:"operational",uptime:"99.87%"}]).map((e,s)=>(0,t.jsx)(em,{label:e.label,status:e.status,uptime:e.uptime},s))})})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{className:"text-lg",children:"Pending Actions"})}),(0,t.jsx)(j,{children:(0,t.jsx)("div",{className:"space-y-3",children:(N||[{priority:"high",title:"KYC Reviews",count:7,action:"Review Pending",actionId:"kyc_reviews"},{priority:"medium",title:"Mail Tagging",count:23,action:"Tag Items",actionId:"mail_tagging"},{priority:"low",title:"User Inquiries",count:4,action:"Respond",actionId:"user_inquiries"}]).map((e,s)=>(0,t.jsx)(eh,{priority:e.priority,title:e.title,count:e.count,action:e.action,actionId:e.actionId,onAction:()=>k(e.actionId,e.actionId)},s))})})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{className:"text-lg",children:"Today's Summary"})}),(0,t.jsx)(j,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"New Registrations"}),(0,t.jsx)("span",{className:"font-semibold",children:C.totalUsers>0?Math.floor(.004*C.totalUsers):12})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Mail Items Received"}),(0,t.jsx)("span",{className:"font-semibold",children:C.mailProcessed>0?Math.floor(.005*C.mailProcessed):89})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Forwards Initiated"}),(0,t.jsx)("span",{className:"font-semibold",children:C.activeForwards>0?Math.floor(.03*C.activeForwards):34})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Support Tickets"}),(0,t.jsx)("span",{className:"font-semibold",children:"7"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Revenue"}),(0,t.jsx)("span",{className:"font-semibold",children:"\xa31,247"})]})]})})]})]})]})}function ec(e){let{title:s,value:a,change:i,trend:r,icon:n,loading:l}=e;return(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:s}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:l?"...":a}),(0,t.jsxs)("p",{className:"text-xs flex items-center gap-1 ".concat("up"===r?"text-green-600":"text-red-600"),children:["up"===r?(0,t.jsx)(et.Z,{className:"h-3 w-3"}):(0,t.jsx)(ei.Z,{className:"h-3 w-3"}),l?"...":i]})]}),n]})})})}function eo(e){let{icon:s,title:a,description:i,time:r}=e,n={UserCheck:(0,t.jsx)(er.Z,{className:"h-4 w-4 text-green-500"}),Mail:(0,t.jsx)(q.Z,{className:"h-4 w-4 text-blue-500"}),Truck:(0,t.jsx)(G.Z,{className:"h-4 w-4 text-orange-500"}),CreditCard:(0,t.jsx)(O.Z,{className:"h-4 w-4 text-purple-500"})};return(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:n[s]||(0,t.jsx)(en.Z,{className:"h-4 w-4 text-gray-500"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:a}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:i}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function em(e){let{label:s,status:a,uptime:i}=e,r={operational:(0,t.jsx)(k.Z,{className:"h-4 w-4"}),warning:(0,t.jsx)(H.Z,{className:"h-4 w-4"}),error:(0,t.jsx)(el.Z,{className:"h-4 w-4"})};return(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:{operational:"text-green-500",warning:"text-yellow-500",error:"text-red-500"}[a],children:r[a]}),(0,t.jsx)("span",{className:"text-sm",children:s})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Uptime"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:i})]})]})}function eh(e){let{priority:s,title:a,count:i,action:r,actionId:n,onAction:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(ee,{className:{high:"text-red-600 bg-red-50",medium:"text-yellow-600 bg-yellow-50",low:"text-blue-600 bg-blue-50"}[s],variant:"secondary",children:s}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:a}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[i," items"]})]})]}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:l,children:r})]})}let ex=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:c("w-full caption-bottom text-sm",a),...i})})});ex.displayName="Table";let eu=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("thead",{ref:s,className:c("[&_tr]:border-b",a),...i})});eu.displayName="TableHeader";let ej=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("tbody",{ref:s,className:c("[&_tr:last-child]:border-0",a),...i})});ej.displayName="TableBody",i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("tfoot",{ref:s,className:c("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...i})}).displayName="TableFooter";let ep=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("tr",{ref:s,className:c("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...i})});ep.displayName="TableRow";let eg=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("th",{ref:s,className:c("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...i})});eg.displayName="TableHead";let ef=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("td",{ref:s,className:c("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...i})});ef.displayName="TableCell",i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("caption",{ref:s,className:c("mt-4 text-sm text-muted-foreground",a),...i})}).displayName="TableCaption";var ev=a(7864),eN=a(875),ey=a(2135),ew=a(401);let eb=ev.fC;ev.ZA;let e_=ev.B4,ek=i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(ev.xz,{ref:s,className:c("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[i,(0,t.jsx)(ev.JO,{asChild:!0,children:(0,t.jsx)(eN.Z,{className:"h-4 w-4 opacity-50"})})]})});ek.displayName=ev.xz.displayName;let eC=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(ev.u_,{ref:s,className:c("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(ey.Z,{className:"h-4 w-4"})})});eC.displayName=ev.u_.displayName;let eS=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(ev.$G,{ref:s,className:c("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(eN.Z,{className:"h-4 w-4"})})});eS.displayName=ev.$G.displayName;let eA=i.forwardRef((e,s)=>{let{className:a,children:i,position:r="popper",...n}=e;return(0,t.jsx)(ev.h_,{children:(0,t.jsxs)(ev.VY,{ref:s,className:c("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...n,children:[(0,t.jsx)(eC,{}),(0,t.jsx)(ev.l_,{className:c("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,t.jsx)(eS,{})]})})});eA.displayName=ev.VY.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(ev.__,{ref:s,className:c("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...i})}).displayName=ev.__.displayName;let eL=i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(ev.ck,{ref:s,className:c("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(ev.wU,{children:(0,t.jsx)(ew.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(ev.eT,{children:i})]})});eL.displayName=ev.ck.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(ev.Z0,{ref:s,className:c("-mx-1 my-1 h-px bg-muted",a),...i})}).displayName=ev.Z0.displayName;var eZ=a(9397),eP=a(3745),eI=a(3247),eT=a(4630),eF=a(6266),eR=a(9707);let eU=eR.fC,ez=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(eR.aV,{ref:s,className:c("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...i})});ez.displayName=eR.aV.displayName;let eE=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(eR.xz,{ref:s,className:c("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...i})});eE.displayName=eR.xz.displayName;let eD=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(eR.VY,{ref:s,className:c("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i})});eD.displayName=eR.VY.displayName;var eM=a(7806),eV=a(2369),eq=a(8420),eG=a(3774),eO=a(3229);function eB(e){let{onSuccess:s,onCancel:a}=e,[r,n]=(0,i.useState)({firstName:"",lastName:"",email:"",phone:"",companyName:"",businessType:"",companyNumber:"",vatNumber:"",addressLine1:"",addressLine2:"",city:"",postcode:"",country:"United Kingdom",plan:"basic",role:"user",isAdmin:!1,sendWelcomeEmail:!0,password:"",confirmPassword:""}),[l,d]=(0,i.useState)(!1),[c,o]=(0,i.useState)(""),[g,f]=(0,i.useState)(""),[N,C]=(0,i.useState)(!1),[L,Z]=(0,i.useState)(!1),[P,T]=(0,i.useState)({}),F=(e,s)=>{n(a=>({...a,[e]:s})),P[e]&&T(s=>({...s,[e]:""}))},U=()=>{let e={};if(r.firstName.trim()||(e.firstName="First name is required"),r.lastName.trim()||(e.lastName="Last name is required"),r.email.trim()?z(r.email)||(e.email="Please enter a valid email address"):e.email="Email is required",r.companyName.trim()||(e.companyName="Company name is required"),r.addressLine1.trim()||(e.addressLine1="Address is required"),r.city.trim()||(e.city="City is required"),r.postcode.trim()||(e.postcode="Postcode is required"),r.password){let s=function(e){let s=[];return e.length<8&&s.push("Password must be at least 8 characters long"),/[A-Z]/.test(e)||s.push("Password must contain at least one uppercase letter"),/[a-z]/.test(e)||s.push("Password must contain at least one lowercase letter"),/\d/.test(e)||s.push("Password must contain at least one number"),/[!@#$%^&*(),.?":{}|<>]/.test(e)||s.push("Password must contain at least one special character"),{valid:0===s.length,errors:s}}(r.password);s.valid||(e.password=s.errors[0])}else e.password="Password is required";return r.password!==r.confirmPassword&&(e.confirmPassword="Passwords do not match"),r.phone&&!/^[\+]?[0-9\s\-\(\)]{10,}$/.test(r.phone)&&(e.phone="Please enter a valid phone number"),T(e),0===Object.keys(e).length},E=async e=>{if(e.preventDefault(),o(""),f(""),!U()){o("Please fix the validation errors below");return}d(!0);try{await R("admin_create_user_started",{email:r.email,companyName:r.companyName,plan:r.plan,isAdmin:r.isAdmin});let e={firstName:r.firstName.trim(),lastName:r.lastName.trim(),email:r.email.trim().toLowerCase(),phone:r.phone.trim(),companyName:r.companyName.trim(),businessType:r.businessType.trim(),companyNumber:r.companyNumber.trim(),vatNumber:r.vatNumber.trim(),address:{line1:r.addressLine1.trim(),line2:r.addressLine2.trim(),city:r.city.trim(),postcode:r.postcode.trim(),country:r.country},plan:r.plan,role:r.role,is_admin:r.isAdmin,send_welcome_email:r.sendWelcomeEmail,password:r.password},a=await I.post("/api/admin/users/create",e);await R("admin_create_user_success",{userId:a.user.id,email:r.email,companyName:r.companyName}),f("User created successfully!"),setTimeout(()=>{s(a.user)},1500)}catch(e){await R("admin_create_user_error",{email:r.email,error:e.message}),o(e.message||"Failed to create user")}finally{d(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,t.jsx)("div",{className:"bg-background rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eM.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Create New User"})]}),(0,t.jsx)(m,{variant:"ghost",size:"sm",onClick:a,children:(0,t.jsx)(K.Z,{className:"h-4 w-4"})})]}),c&&(0,t.jsxs)(y,{className:"mb-4",variant:"destructive",children:[(0,t.jsx)(_.Z,{className:"h-4 w-4"}),(0,t.jsx)(w,{children:c})]}),g&&(0,t.jsxs)(y,{className:"mb-4",children:[(0,t.jsx)(k.Z,{className:"h-4 w-4"}),(0,t.jsx)(w,{children:g})]}),(0,t.jsxs)("form",{onSubmit:E,children:[(0,t.jsxs)(eU,{defaultValue:"personal",className:"space-y-6",children:[(0,t.jsxs)(ez,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(eE,{value:"personal",children:"Personal"}),(0,t.jsx)(eE,{value:"business",children:"Business"}),(0,t.jsx)(eE,{value:"address",children:"Address"}),(0,t.jsx)(eE,{value:"account",children:"Account"})]}),(0,t.jsx)(eD,{value:"personal",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(eV.Z,{className:"h-5 w-5"}),"Personal Information"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"firstName",children:"First Name *"}),(0,t.jsx)(p,{id:"firstName",value:r.firstName,onChange:e=>F("firstName",e.target.value),placeholder:"John",className:P.firstName?"border-red-500":""}),P.firstName&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.firstName})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"lastName",children:"Last Name *"}),(0,t.jsx)(p,{id:"lastName",value:r.lastName,onChange:e=>F("lastName",e.target.value),placeholder:"Doe",className:P.lastName?"border-red-500":""}),P.lastName&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.lastName})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"email",children:"Email Address *"}),(0,t.jsx)(p,{id:"email",type:"email",value:r.email,onChange:e=>F("email",e.target.value),placeholder:"john.doe@company.com",className:P.email?"border-red-500":""}),P.email&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.email})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"phone",children:"Phone Number"}),(0,t.jsx)(p,{id:"phone",type:"tel",value:r.phone,onChange:e=>F("phone",e.target.value),placeholder:"+44 20 7123 4567",className:P.phone?"border-red-500":""}),P.phone&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.phone})]})]})]})}),(0,t.jsx)(eD,{value:"business",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(eq.Z,{className:"h-5 w-5"}),"Business Information"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"companyName",children:"Company Name *"}),(0,t.jsx)(p,{id:"companyName",value:r.companyName,onChange:e=>F("companyName",e.target.value),placeholder:"Acme Corporation Ltd",className:P.companyName?"border-red-500":""}),P.companyName&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.companyName})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"businessType",children:"Business Type"}),(0,t.jsxs)(eb,{value:r.businessType,onValueChange:e=>F("businessType",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{placeholder:"Select business type"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"limited_company",children:"Limited Company"}),(0,t.jsx)(eL,{value:"sole_trader",children:"Sole Trader"}),(0,t.jsx)(eL,{value:"partnership",children:"Partnership"}),(0,t.jsx)(eL,{value:"llp",children:"Limited Liability Partnership"}),(0,t.jsx)(eL,{value:"charity",children:"Charity"}),(0,t.jsx)(eL,{value:"other",children:"Other"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"companyNumber",children:"Company Number"}),(0,t.jsx)(p,{id:"companyNumber",value:r.companyNumber,onChange:e=>F("companyNumber",e.target.value),placeholder:"12345678"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"vatNumber",children:"VAT Number"}),(0,t.jsx)(p,{id:"vatNumber",value:r.vatNumber,onChange:e=>F("vatNumber",e.target.value),placeholder:"GB123456789"})]})]})]})]})}),(0,t.jsx)(eD,{value:"address",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(eG.Z,{className:"h-5 w-5"}),"Address Information"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"addressLine1",children:"Address Line 1 *"}),(0,t.jsx)(p,{id:"addressLine1",value:r.addressLine1,onChange:e=>F("addressLine1",e.target.value),placeholder:"123 Business Street",className:P.addressLine1?"border-red-500":""}),P.addressLine1&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.addressLine1})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"addressLine2",children:"Address Line 2"}),(0,t.jsx)(p,{id:"addressLine2",value:r.addressLine2,onChange:e=>F("addressLine2",e.target.value),placeholder:"Suite 100"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"city",children:"City *"}),(0,t.jsx)(p,{id:"city",value:r.city,onChange:e=>F("city",e.target.value),placeholder:"London",className:P.city?"border-red-500":""}),P.city&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.city})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"postcode",children:"Postcode *"}),(0,t.jsx)(p,{id:"postcode",value:r.postcode,onChange:e=>F("postcode",e.target.value),placeholder:"SW1A 1AA",className:P.postcode?"border-red-500":""}),P.postcode&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.postcode})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"country",children:"Country"}),(0,t.jsxs)(eb,{value:r.country,onValueChange:e=>F("country",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"United Kingdom",children:"United Kingdom"}),(0,t.jsx)(eL,{value:"United States",children:"United States"}),(0,t.jsx)(eL,{value:"Canada",children:"Canada"}),(0,t.jsx)(eL,{value:"Australia",children:"Australia"}),(0,t.jsx)(eL,{value:"Germany",children:"Germany"}),(0,t.jsx)(eL,{value:"France",children:"France"}),(0,t.jsx)(eL,{value:"Other",children:"Other"})]})]})]})]})]})]})}),(0,t.jsx)(eD,{value:"account",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"h-5 w-5"}),"Account Settings"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"plan",children:"Subscription Plan"}),(0,t.jsxs)(eb,{value:r.plan,onValueChange:e=>F("plan",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"basic",children:"Basic - \xa319.99/month"}),(0,t.jsx)(eL,{value:"premium",children:"Premium - \xa339.99/month"}),(0,t.jsx)(eL,{value:"professional",children:"Professional - \xa379.99/month"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"role",children:"User Role"}),(0,t.jsxs)(eb,{value:r.role,onValueChange:e=>F("role",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"user",children:"User"}),(0,t.jsx)(eL,{value:"admin",children:"Admin"}),(0,t.jsx)(eL,{value:"super_admin",children:"Super Admin"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"isAdmin",checked:r.isAdmin,onChange:e=>F("isAdmin",e.target.checked),className:"rounded"}),(0,t.jsx)(v,{htmlFor:"isAdmin",children:"Grant Admin Access"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"sendWelcomeEmail",checked:r.sendWelcomeEmail,onChange:e=>F("sendWelcomeEmail",e.target.checked),className:"rounded"}),(0,t.jsx)(v,{htmlFor:"sendWelcomeEmail",children:"Send Welcome Email"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"password",children:"Password *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(p,{id:"password",type:N?"text":"password",value:r.password,onChange:e=>F("password",e.target.value),placeholder:"Enter secure password",className:P.password?"border-red-500":""}),(0,t.jsx)("button",{type:"button",onClick:()=>C(!N),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",children:N?(0,t.jsx)(S.Z,{className:"h-4 w-4"}):(0,t.jsx)(A.Z,{className:"h-4 w-4"})})]}),P.password&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.password}),(0,t.jsx)(m,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*",s="";for(let a=0;a<12;a++)s+=e.charAt(Math.floor(Math.random()*e.length));n(e=>({...e,password:s,confirmPassword:s}))},className:"mt-2",children:"Generate Secure Password"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"confirmPassword",children:"Confirm Password *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(p,{id:"confirmPassword",type:L?"text":"password",value:r.confirmPassword,onChange:e=>F("confirmPassword",e.target.value),placeholder:"Confirm password",className:P.confirmPassword?"border-red-500":""}),(0,t.jsx)("button",{type:"button",onClick:()=>Z(!L),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",children:L?(0,t.jsx)(S.Z,{className:"h-4 w-4"}):(0,t.jsx)(A.Z,{className:"h-4 w-4"})})]}),P.confirmPassword&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:P.confirmPassword})]})]})]})})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,t.jsx)(m,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),(0,t.jsx)(m,{type:"submit",disabled:l,children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eO.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating User..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eM.Z,{className:"h-4 w-4 mr-2"}),"Create User"]})})]})]})]})})})}function eJ(e){var s,a,r,n,l,d,c;let{user:o,onSuccess:g,onCancel:f}=e,[N,C]=(0,i.useState)({firstName:o.firstName||(null===(s=o.name)||void 0===s?void 0:s.split(" ")[0])||"",lastName:o.lastName||(null===(a=o.name)||void 0===a?void 0:a.split(" ")[1])||"",email:o.email||"",phone:o.phone||"",companyName:o.companyName||"",businessType:o.businessType||"",companyNumber:o.companyNumber||"",vatNumber:o.vatNumber||"",addressLine1:(null===(r=o.address)||void 0===r?void 0:r.line1)||"",addressLine2:(null===(n=o.address)||void 0===n?void 0:n.line2)||"",city:(null===(l=o.address)||void 0===l?void 0:l.city)||"",postcode:(null===(d=o.address)||void 0===d?void 0:d.postcode)||"",country:(null===(c=o.address)||void 0===c?void 0:c.country)||"United Kingdom",plan:o.plan||"basic",role:o.role||"user",isAdmin:o.is_admin||!1,status:o.status||"active",kycStatus:o.kyc_status||"pending"}),[S,A]=(0,i.useState)(!1),[Z,P]=(0,i.useState)(""),[T,F]=(0,i.useState)(""),[U,E]=(0,i.useState)({}),D=(e,s)=>{C(a=>({...a,[e]:s})),U[e]&&E(s=>({...s,[e]:""}))},M=()=>{let e={};return N.firstName.trim()||(e.firstName="First name is required"),N.lastName.trim()||(e.lastName="Last name is required"),N.email.trim()?z(N.email)||(e.email="Please enter a valid email address"):e.email="Email is required",N.companyName.trim()||(e.companyName="Company name is required"),N.addressLine1.trim()||(e.addressLine1="Address is required"),N.city.trim()||(e.city="City is required"),N.postcode.trim()||(e.postcode="Postcode is required"),N.phone&&!/^[\+]?[0-9\s\-\(\)]{10,}$/.test(N.phone)&&(e.phone="Please enter a valid phone number"),E(e),0===Object.keys(e).length},V=async e=>{if(e.preventDefault(),P(""),F(""),!M()){P("Please fix the validation errors below");return}A(!0);try{await R("admin_edit_user_started",{userId:o.id,email:N.email,changes:N});let e={firstName:N.firstName.trim(),lastName:N.lastName.trim(),email:N.email.trim().toLowerCase(),phone:N.phone.trim(),companyName:N.companyName.trim(),businessType:N.businessType.trim(),companyNumber:N.companyNumber.trim(),vatNumber:N.vatNumber.trim(),address:{line1:N.addressLine1.trim(),line2:N.addressLine2.trim(),city:N.city.trim(),postcode:N.postcode.trim(),country:N.country},plan:N.plan,role:N.role,is_admin:N.isAdmin,status:N.status,kyc_status:N.kycStatus},s=await I.put("/api/admin/users/".concat(o.id),e);await R("admin_edit_user_success",{userId:o.id,email:N.email,changes:N}),F("User updated successfully!"),setTimeout(()=>{g(s.user)},1500)}catch(e){await R("admin_edit_user_error",{userId:o.id,email:N.email,error:e.message}),P(e.message||"Failed to update user")}finally{A(!1)}},q=async()=>{A(!0);try{await R("admin_suspend_user",{userId:o.id}),await I.put("/api/admin/users/".concat(o.id,"/suspend")),F("User suspended successfully!"),setTimeout(()=>{g({...o,status:"suspended"})},1500)}catch(e){P(e.message||"Failed to suspend user")}finally{A(!1)}},G=async()=>{A(!0);try{await R("admin_activate_user",{userId:o.id}),await I.put("/api/admin/users/".concat(o.id,"/activate")),F("User activated successfully!"),setTimeout(()=>{g({...o,status:"active"})},1500)}catch(e){P(e.message||"Failed to activate user")}finally{A(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,t.jsx)("div",{className:"bg-background rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eV.Z,{className:"h-6 w-6 text-primary"}),(0,t.jsxs)("h2",{className:"text-2xl font-bold",children:["Edit User: ",o.name]})]}),(0,t.jsx)(m,{variant:"ghost",size:"sm",onClick:f,children:(0,t.jsx)(K.Z,{className:"h-4 w-4"})})]}),Z&&(0,t.jsxs)(y,{className:"mb-4",variant:"destructive",children:[(0,t.jsx)(_.Z,{className:"h-4 w-4"}),(0,t.jsx)(w,{children:Z})]}),T&&(0,t.jsxs)(y,{className:"mb-4",children:[(0,t.jsx)(k.Z,{className:"h-4 w-4"}),(0,t.jsx)(w,{children:T})]}),(0,t.jsxs)("form",{onSubmit:V,children:[(0,t.jsxs)(eU,{defaultValue:"personal",className:"space-y-6",children:[(0,t.jsxs)(ez,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(eE,{value:"personal",children:"Personal"}),(0,t.jsx)(eE,{value:"business",children:"Business"}),(0,t.jsx)(eE,{value:"address",children:"Address"}),(0,t.jsx)(eE,{value:"account",children:"Account"})]}),(0,t.jsx)(eD,{value:"personal",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(eV.Z,{className:"h-5 w-5"}),"Personal Information"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"firstName",children:"First Name *"}),(0,t.jsx)(p,{id:"firstName",value:N.firstName,onChange:e=>D("firstName",e.target.value),placeholder:"John",className:U.firstName?"border-red-500":""}),U.firstName&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.firstName})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"lastName",children:"Last Name *"}),(0,t.jsx)(p,{id:"lastName",value:N.lastName,onChange:e=>D("lastName",e.target.value),placeholder:"Doe",className:U.lastName?"border-red-500":""}),U.lastName&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.lastName})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"email",children:"Email Address *"}),(0,t.jsx)(p,{id:"email",type:"email",value:N.email,onChange:e=>D("email",e.target.value),placeholder:"john.doe@company.com",className:U.email?"border-red-500":""}),U.email&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.email})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"phone",children:"Phone Number"}),(0,t.jsx)(p,{id:"phone",type:"tel",value:N.phone,onChange:e=>D("phone",e.target.value),placeholder:"+44 20 7123 4567",className:U.phone?"border-red-500":""}),U.phone&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.phone})]})]})]})}),(0,t.jsx)(eD,{value:"business",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(eq.Z,{className:"h-5 w-5"}),"Business Information"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"companyName",children:"Company Name *"}),(0,t.jsx)(p,{id:"companyName",value:N.companyName,onChange:e=>D("companyName",e.target.value),placeholder:"Acme Corporation Ltd",className:U.companyName?"border-red-500":""}),U.companyName&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.companyName})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"businessType",children:"Business Type"}),(0,t.jsxs)(eb,{value:N.businessType,onValueChange:e=>D("businessType",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{placeholder:"Select business type"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"limited_company",children:"Limited Company"}),(0,t.jsx)(eL,{value:"sole_trader",children:"Sole Trader"}),(0,t.jsx)(eL,{value:"partnership",children:"Partnership"}),(0,t.jsx)(eL,{value:"llp",children:"Limited Liability Partnership"}),(0,t.jsx)(eL,{value:"charity",children:"Charity"}),(0,t.jsx)(eL,{value:"other",children:"Other"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"companyNumber",children:"Company Number"}),(0,t.jsx)(p,{id:"companyNumber",value:N.companyNumber,onChange:e=>D("companyNumber",e.target.value),placeholder:"12345678"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"vatNumber",children:"VAT Number"}),(0,t.jsx)(p,{id:"vatNumber",value:N.vatNumber,onChange:e=>D("vatNumber",e.target.value),placeholder:"GB123456789"})]})]})]})]})}),(0,t.jsx)(eD,{value:"address",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(eG.Z,{className:"h-5 w-5"}),"Address Information"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"addressLine1",children:"Address Line 1 *"}),(0,t.jsx)(p,{id:"addressLine1",value:N.addressLine1,onChange:e=>D("addressLine1",e.target.value),placeholder:"123 Business Street",className:U.addressLine1?"border-red-500":""}),U.addressLine1&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.addressLine1})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"addressLine2",children:"Address Line 2"}),(0,t.jsx)(p,{id:"addressLine2",value:N.addressLine2,onChange:e=>D("addressLine2",e.target.value),placeholder:"Suite 100"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"city",children:"City *"}),(0,t.jsx)(p,{id:"city",value:N.city,onChange:e=>D("city",e.target.value),placeholder:"London",className:U.city?"border-red-500":""}),U.city&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.city})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"postcode",children:"Postcode *"}),(0,t.jsx)(p,{id:"postcode",value:N.postcode,onChange:e=>D("postcode",e.target.value),placeholder:"SW1A 1AA",className:U.postcode?"border-red-500":""}),U.postcode&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:U.postcode})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"country",children:"Country"}),(0,t.jsxs)(eb,{value:N.country,onValueChange:e=>D("country",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"United Kingdom",children:"United Kingdom"}),(0,t.jsx)(eL,{value:"United States",children:"United States"}),(0,t.jsx)(eL,{value:"Canada",children:"Canada"}),(0,t.jsx)(eL,{value:"Australia",children:"Australia"}),(0,t.jsx)(eL,{value:"Germany",children:"Germany"}),(0,t.jsx)(eL,{value:"France",children:"France"}),(0,t.jsx)(eL,{value:"Other",children:"Other"})]})]})]})]})]})]})}),(0,t.jsx)(eD,{value:"account",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsxs)(u,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"h-5 w-5"}),"Account Settings"]})}),(0,t.jsxs)(j,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"plan",children:"Subscription Plan"}),(0,t.jsxs)(eb,{value:N.plan,onValueChange:e=>D("plan",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"basic",children:"Basic - \xa319.99/month"}),(0,t.jsx)(eL,{value:"premium",children:"Premium - \xa339.99/month"}),(0,t.jsx)(eL,{value:"professional",children:"Professional - \xa379.99/month"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"role",children:"User Role"}),(0,t.jsxs)(eb,{value:N.role,onValueChange:e=>D("role",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"user",children:"User"}),(0,t.jsx)(eL,{value:"admin",children:"Admin"}),(0,t.jsx)(eL,{value:"super_admin",children:"Super Admin"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"status",children:"Account Status"}),(0,t.jsxs)(eb,{value:N.status,onValueChange:e=>D("status",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"active",children:"Active"}),(0,t.jsx)(eL,{value:"suspended",children:"Suspended"}),(0,t.jsx)(eL,{value:"pending",children:"Pending"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"kycStatus",children:"KYC Status"}),(0,t.jsxs)(eb,{value:N.kycStatus,onValueChange:e=>D("kycStatus",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"pending",children:"Pending"}),(0,t.jsx)(eL,{value:"approved",children:"Approved"}),(0,t.jsx)(eL,{value:"rejected",children:"Rejected"})]})]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"isAdmin",checked:N.isAdmin,onChange:e=>D("isAdmin",e.target.checked),className:"rounded"}),(0,t.jsx)(v,{htmlFor:"isAdmin",children:"Grant Admin Access"})]})})]})]})})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,t.jsx)("div",{className:"flex gap-2",children:"active"===N.status?(0,t.jsxs)(m,{type:"button",variant:"destructive",onClick:q,disabled:S,children:[(0,t.jsx)(eP.Z,{className:"h-4 w-4 mr-2"}),"Suspend User"]}):(0,t.jsxs)(m,{type:"button",onClick:G,disabled:S,children:[(0,t.jsx)(er.Z,{className:"h-4 w-4 mr-2"}),"Activate User"]})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(m,{type:"button",variant:"outline",onClick:f,children:"Cancel"}),(0,t.jsx)(m,{type:"submit",disabled:S,children:S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eO.Z,{className:"h-4 w-4 mr-2"}),"Update User"]})})]})]})]})]})})})}function eH(e){let{onNavigate:s}=e,[a,r]=(0,i.useState)(""),[n,l]=(0,i.useState)("all"),[d,c]=(0,i.useState)("all"),[o,x]=(0,i.useState)("all"),[u,g]=(0,i.useState)(!1),[f,v]=(0,i.useState)([]),[N,y]=(0,i.useState)(!1),[w,b]=(0,i.useState)(!1),[_,C]=(0,i.useState)(null),{data:S,isLoading:L,refetch:Z}=E("/api/admin/users"),{data:P,isLoading:T}=E("/api/admin/users/stats"),F=S||[{id:1,name:"Jane Doe",email:"jane@example.com",kyc:"approved",plan:"premium",status:"active",joined:"2023-08-15",lastLogin:"2 hours ago",mailCount:23,totalSpent:"\xa3299.88",companyName:"Doe Enterprises Ltd",address:"123 Business St, London",phone:"+44 20 7123 4567"},{id:2,name:"John Smith",email:"john@example.com",kyc:"pending",plan:"basic",status:"active",joined:"2023-09-02",lastLogin:"1 day ago",mailCount:8,totalSpent:"\xa339.99",companyName:"Smith Consulting",address:"456 High St, Manchester",phone:"+44 161 234 5678"},{id:3,name:"Alice Johnson",email:"alice@example.com",kyc:"approved",plan:"professional",status:"suspended",joined:"2023-07-20",lastLogin:"5 days ago",mailCount:156,totalSpent:"\xa31,247.50",companyName:"Johnson & Associates",address:"789 Corporate Ave, Birmingham",phone:"+44 121 345 6789"}],U=F.filter(e=>{let s=e.name.toLowerCase().includes(a.toLowerCase())||e.email.toLowerCase().includes(a.toLowerCase())||e.companyName&&e.companyName.toLowerCase().includes(a.toLowerCase()),t="all"===n||e.status===n,i="all"===d||e.plan===d,r="all"===o||e.kyc===o;return s&&t&&i&&r}),z=async()=>{g(!0);try{await R("admin_export_users",{filters:{statusFilter:n,planFilter:d,kycFilter:o,searchTerm:a}});let e=await I.get("/api/admin/users/export",{params:{status:n,plan:d,kyc:o,search:a}}),s=new Blob([e.data],{type:"application/json"}),t=window.URL.createObjectURL(s),i=document.createElement("a");i.href=t,i.download="users-export-".concat(new Date().toISOString().split("T")[0],".json"),i.click()}catch(e){await R("admin_export_users_error",{error:e.message})}finally{g(!1)}},D=async()=>{try{await R("admin_add_user_initiated"),y(!0)}catch(e){await R("admin_add_user_error",{error:e.message})}},M=async e=>{try{await R("admin_user_created_success",{userId:e.id,email:e.email}),y(!1),Z()}catch(e){await R("admin_user_created_error",{error:e.message})}},V=async e=>{try{await R("admin_view_user",{userId:e}),s?s("user-detail",{userId:e}):window.open("/admin/users/".concat(e),"_blank")}catch(s){await R("admin_view_user_error",{userId:e,error:s.message})}},q=async e=>{try{await R("admin_edit_user_initiated",{userId:e});let s=F.find(s=>s.id===e);s&&(C(s),b(!0))}catch(s){await R("admin_edit_user_error",{userId:e,error:s.message})}},G=async e=>{try{await R("admin_user_updated_success",{userId:e.id,email:e.email}),b(!1),C(null),Z()}catch(e){await R("admin_user_updated_error",{error:e.message})}},O=async(e,s)=>{g(!0);try{await R("admin_update_kyc_status",{userId:e,newStatus:s}),await I.put("/api/admin/users/".concat(e,"/kyc-status"),{status:s}),Z()}catch(a){await R("admin_update_kyc_status_error",{userId:e,newStatus:s,error:a.message})}finally{g(!1)}},B=async e=>{g(!0);try{await R("admin_suspend_user",{userId:e}),await I.put("/api/admin/users/".concat(e,"/suspend")),Z()}catch(s){await R("admin_suspend_user_error",{userId:e,error:s.message})}finally{g(!1)}},J=async e=>{g(!0);try{await R("admin_activate_user",{userId:e}),await I.put("/api/admin/users/".concat(e,"/activate")),Z()}catch(s){await R("admin_activate_user_error",{userId:e,error:s.message})}finally{g(!1)}},H=async e=>{if(0!==f.length){g(!0);try{await R("admin_bulk_action",{action:e,userIds:f}),await I.post("/api/admin/users/bulk/".concat(e),{userIds:f}),v([]),Z()}catch(s){await R("admin_bulk_action_error",{action:e,userIds:f,error:s.message})}finally{g(!1)}}},K=e=>{v(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},Y=()=>{v([])};return(0,t.jsxs)("div",{className:"space-y-6",children:[N&&(0,t.jsx)(eB,{onSuccess:M,onCancel:()=>{y(!1)}}),w&&_&&(0,t.jsx)(eJ,{user:_,onSuccess:G,onCancel:()=>{b(!1),C(null)}}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage user accounts, KYC status, and subscriptions"}),P&&(0,t.jsxs)("div",{className:"flex gap-4 mt-2 text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Total: ",P.total]}),(0,t.jsxs)("span",{children:["Active: ",P.active]}),(0,t.jsxs)("span",{children:["Pending KYC: ",P.pendingKyc]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:z,disabled:u,children:[(0,t.jsx)(W.Z,{className:"h-4 w-4"}),"Export Users"]}),(0,t.jsxs)(m,{className:"gap-2",onClick:D,disabled:u,children:[(0,t.jsx)(eZ.Z,{className:"h-4 w-4"}),"Add User"]})]})]}),f.length>0&&(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[f.length," users selected"]}),(0,t.jsx)(m,{variant:"ghost",size:"sm",onClick:Y,children:"Clear"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>H("suspend"),disabled:u,children:[(0,t.jsx)(eP.Z,{className:"h-4 w-4"}),"Suspend"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>H("activate"),disabled:u,children:[(0,t.jsx)(er.Z,{className:"h-4 w-4"}),"Activate"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>H("export"),disabled:u,children:[(0,t.jsx)(W.Z,{className:"h-4 w-4"}),"Export Selected"]})]})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eI.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(p,{placeholder:"Search users by name, email, or company...",value:a,onChange:e=>r(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(eb,{value:n,onValueChange:l,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"Status"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All Status"}),(0,t.jsx)(eL,{value:"active",children:"Active"}),(0,t.jsx)(eL,{value:"suspended",children:"Suspended"}),(0,t.jsx)(eL,{value:"pending",children:"Pending"})]})]}),(0,t.jsxs)(eb,{value:d,onValueChange:c,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"Plan"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All Plans"}),(0,t.jsx)(eL,{value:"basic",children:"Basic"}),(0,t.jsx)(eL,{value:"premium",children:"Premium"}),(0,t.jsx)(eL,{value:"professional",children:"Professional"})]})]}),(0,t.jsxs)(eb,{value:o,onValueChange:x,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"KYC"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All KYC"}),(0,t.jsx)(eL,{value:"approved",children:"Approved"}),(0,t.jsx)(eL,{value:"pending",children:"Pending"}),(0,t.jsx)(eL,{value:"rejected",children:"Rejected"})]})]})]})]})})}),(0,t.jsx)("div",{className:"hidden lg:block",children:(0,t.jsx)(h,{children:(0,t.jsxs)(ex,{children:[(0,t.jsx)(eu,{children:(0,t.jsxs)(ep,{children:[(0,t.jsx)(eg,{className:"w-12",children:(0,t.jsx)("input",{type:"checkbox",checked:f.length===U.length&&U.length>0,onChange:f.length===U.length?Y:()=>{v(U.map(e=>e.id))},className:"rounded"})}),(0,t.jsx)(eg,{children:"User"}),(0,t.jsx)(eg,{children:"KYC Status"}),(0,t.jsx)(eg,{children:"Plan"}),(0,t.jsx)(eg,{children:"Status"}),(0,t.jsx)(eg,{children:"Mail Count"}),(0,t.jsx)(eg,{children:"Total Spent"}),(0,t.jsx)(eg,{children:"Last Login"}),(0,t.jsx)(eg,{children:"Actions"})]})}),(0,t.jsx)(ej,{children:U.map(e=>(0,t.jsxs)(ep,{children:[(0,t.jsx)(ef,{children:(0,t.jsx)("input",{type:"checkbox",checked:f.includes(e.id),onChange:()=>K(e.id),className:"rounded"})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email}),e.companyName&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.companyName}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Joined ",e.joined]})]})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ee,{variant:"approved"===e.kyc?"default":"pending"===e.kyc?"secondary":"destructive",children:e.kyc}),"pending"===e.kyc&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>O(e.id,"approved"),disabled:u,children:(0,t.jsx)(k.Z,{className:"h-3 w-3"})})]})}),(0,t.jsx)(ef,{children:(0,t.jsx)(ee,{variant:"outline",className:"capitalize",children:e.plan})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ee,{variant:"active"===e.status?"default":"destructive",children:e.status}),"suspended"===e.status?(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>J(e.id),disabled:u,children:(0,t.jsx)(er.Z,{className:"h-3 w-3"})}):(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>B(e.id),disabled:u,children:(0,t.jsx)(eP.Z,{className:"h-3 w-3"})})]})}),(0,t.jsx)(ef,{children:e.mailCount}),(0,t.jsx)(ef,{children:e.totalSpent}),(0,t.jsx)(ef,{className:"text-sm text-muted-foreground",children:e.lastLogin}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>V(e.id),children:(0,t.jsx)(A.Z,{className:"h-4 w-4"})}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>q(e.id),children:(0,t.jsx)(eT.Z,{className:"h-4 w-4"})}),(0,t.jsx)(m,{size:"sm",variant:"outline",children:(0,t.jsx)(eF.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),(0,t.jsx)("div",{className:"lg:hidden space-y-4",children:U.map(e=>(0,t.jsx)(h,{children:(0,t.jsxs)(j,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("input",{type:"checkbox",checked:f.includes(e.id),onChange:()=>K(e.id),className:"rounded mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email}),e.companyName&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.companyName}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Joined ",e.joined]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)(ee,{variant:"approved"===e.kyc?"default":"secondary",className:"mb-1",children:e.kyc}),(0,t.jsx)("br",{}),(0,t.jsx)(ee,{variant:"active"===e.status?"default":"destructive",children:e.status})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Plan:"})," ",(0,t.jsx)("span",{className:"capitalize",children:e.plan})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Mail:"})," ",e.mailCount]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Spent:"})," ",e.totalSpent]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Login:"})," ",e.lastLogin]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(m,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>V(e.id),children:"View"}),(0,t.jsx)(m,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>q(e.id),children:"Edit"}),(0,t.jsx)(m,{size:"sm",variant:"outline",className:"flex-1",children:"Actions"})]})]})},e.id))})]})}var eK=a(1723),eY=a(2720),eW=a(8930);function e$(e){let{}=e,[s,a]=(0,i.useState)("received"),[r,n]=(0,i.useState)(""),[l,d]=(0,i.useState)("all"),[c,o]=(0,i.useState)("all"),[x,u]=(0,i.useState)(!1),[g,f]=(0,i.useState)([]),{data:v,isLoading:N,refetch:y}=E("/api/admin/mail-items"),{data:w,isLoading:b}=E("/api/admin/mail-items/stats"),_=(v||[{id:101,userId:1,userName:"Jane Doe",sender:"HMRC",subject:"Tax Notice",tag:"Government",status:"received",received:"2 hours ago",scanned:!0,weight:"0.2kg",dimensions:"A4"},{id:102,userId:2,userName:"John Smith",sender:"Lloyds Bank",subject:"Account Statement",tag:"Financial",status:"pending",received:"4 hours ago",scanned:!1,weight:"0.1kg",dimensions:"A4"},{id:103,userId:3,userName:"Alice Johnson",sender:"Royal Mail",subject:"Delivery Notification",tag:"Logistics",status:"processed",received:"6 hours ago",scanned:!0,forwarded:!0,trackingNumber:"FR-2847",weight:"0.5kg",dimensions:"Small Package"}]).filter(e=>{let a=e.userName.toLowerCase().includes(r.toLowerCase())||e.sender.toLowerCase().includes(r.toLowerCase())||e.subject.toLowerCase().includes(r.toLowerCase()),t="all"===l||e.status===l,i="all"===c||e.tag===c,n="all"===s||e.status===s;return a&&t&&i&&n}),C=async()=>{try{await R("admin_add_mail_item"),window.open("/admin/mail/add","_blank")}catch(e){await R("admin_add_mail_item_error",{error:e.message})}},S=async e=>{try{await R("admin_view_mail_item",{itemId:e}),window.open("/admin/mail/".concat(e),"_blank")}catch(s){await R("admin_view_mail_item_error",{itemId:e,error:s.message})}},A=async e=>{try{await R("admin_edit_mail_item",{itemId:e}),window.open("/admin/mail/".concat(e,"/edit"),"_blank")}catch(s){await R("admin_edit_mail_item_error",{itemId:e,error:s.message})}},L=async e=>{u(!0);try{await R("admin_process_mail_item",{itemId:e}),await I.post("/api/admin/mail-items/".concat(e,"/process")),y()}catch(s){await R("admin_process_mail_item_error",{itemId:e,error:s.message})}finally{u(!1)}},Z=async(e,s)=>{u(!0);try{await R("admin_tag_mail_item",{itemId:e,tag:s}),await I.post("/api/admin/mail-items/".concat(e,"/tag"),{tag:s}),y()}catch(a){await R("admin_tag_mail_item_error",{itemId:e,tag:s,error:a.message})}finally{u(!1)}},P=async e=>{u(!0);try{await R("admin_forward_mail_item",{itemId:e}),await I.post("/api/admin/mail-items/".concat(e,"/forward")),y()}catch(s){await R("admin_forward_mail_item_error",{itemId:e,error:s.message})}finally{u(!1)}},T=async e=>{u(!0);try{await R("admin_delete_mail_item",{itemId:e}),await I.delete("/api/admin/mail-items/".concat(e)),y()}catch(s){await R("admin_delete_mail_item_error",{itemId:e,error:s.message})}finally{u(!1)}},F=async e=>{if(0!==g.length){u(!0);try{await R("admin_bulk_mail_action",{action:e,itemIds:g}),await I.post("/api/admin/mail-items/bulk/".concat(e),{itemIds:g}),f([]),y()}catch(s){await R("admin_bulk_mail_action_error",{action:e,itemIds:g,error:s.message})}finally{u(!1)}}},U=async()=>{u(!0);try{await R("admin_export_mail",{filters:{statusFilter:l,tagFilter:c,searchTerm:r,tab:s}});let e=await I.get("/api/admin/mail-items/export",{params:{status:l,tag:c,search:r,tab:s}}),a=new Blob([e.data],{type:"application/json"}),t=window.URL.createObjectURL(a),i=document.createElement("a");i.href=t,i.download="mail-items-export-".concat(new Date().toISOString().split("T")[0],".json"),i.click()}catch(e){await R("admin_export_mail_error",{error:e.message})}finally{u(!1)}},z=e=>{f(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Mail Management"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Process and manage incoming mail and packages"}),w&&(0,t.jsxs)("div",{className:"flex gap-4 mt-2 text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Total: ",w.total]}),(0,t.jsxs)("span",{children:["Received: ",w.received]}),(0,t.jsxs)("span",{children:["Pending: ",w.pending]}),(0,t.jsxs)("span",{children:["Processed: ",w.processed]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:U,disabled:x,children:[(0,t.jsx)(W.Z,{className:"h-4 w-4"}),"Export"]}),(0,t.jsxs)(m,{className:"gap-2",onClick:C,disabled:x,children:[(0,t.jsx)(eZ.Z,{className:"h-4 w-4"}),"Add Item"]})]})]}),g.length>0&&(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[g.length," items selected"]}),(0,t.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>{f([])},children:"Clear"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>F("process"),disabled:x,children:[(0,t.jsx)(k.Z,{className:"h-4 w-4"}),"Process"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>F("tag"),disabled:x,children:[(0,t.jsx)(eY.Z,{className:"h-4 w-4"}),"Tag"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>F("forward"),disabled:x,children:[(0,t.jsx)(G.Z,{className:"h-4 w-4"}),"Forward"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>F("delete"),disabled:x,children:[(0,t.jsx)(eW.Z,{className:"h-4 w-4"}),"Delete"]})]})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eI.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(p,{placeholder:"Search mail items...",value:r,onChange:e=>n(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(eb,{value:l,onValueChange:d,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"Status"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All Status"}),(0,t.jsx)(eL,{value:"received",children:"Received"}),(0,t.jsx)(eL,{value:"pending",children:"Pending"}),(0,t.jsx)(eL,{value:"processed",children:"Processed"}),(0,t.jsx)(eL,{value:"forwarded",children:"Forwarded"})]})]}),(0,t.jsxs)(eb,{value:c,onValueChange:o,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"Tag"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All Tags"}),(0,t.jsx)(eL,{value:"Government",children:"Government"}),(0,t.jsx)(eL,{value:"Financial",children:"Financial"}),(0,t.jsx)(eL,{value:"Logistics",children:"Logistics"}),(0,t.jsx)(eL,{value:"Legal",children:"Legal"}),(0,t.jsx)(eL,{value:"Personal",children:"Personal"})]})]})]})]})})}),(0,t.jsxs)(eU,{value:s,onValueChange:a,children:[(0,t.jsxs)(ez,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(eE,{value:"received",children:"Received"}),(0,t.jsx)(eE,{value:"pending",children:"Pending"}),(0,t.jsx)(eE,{value:"processed",children:"Processed"}),(0,t.jsx)(eE,{value:"forwarded",children:"Forwarded"})]}),(0,t.jsx)(eD,{value:"received",className:"space-y-4",children:(0,t.jsx)(eQ,{items:_.filter(e=>"received"===e.status),onView:S,onEdit:A,onProcess:L,onTag:Z,onForward:P,onDelete:T,onSelect:z,selectedItems:g,loading:x})}),(0,t.jsx)(eD,{value:"pending",className:"space-y-4",children:(0,t.jsx)(eQ,{items:_.filter(e=>"pending"===e.status),onView:S,onEdit:A,onProcess:L,onTag:Z,onForward:P,onDelete:T,onSelect:z,selectedItems:g,loading:x})}),(0,t.jsx)(eD,{value:"processed",className:"space-y-4",children:(0,t.jsx)(eQ,{items:_.filter(e=>"processed"===e.status),onView:S,onEdit:A,onProcess:L,onTag:Z,onForward:P,onDelete:T,onSelect:z,selectedItems:g,loading:x})}),(0,t.jsx)(eD,{value:"forwarded",className:"space-y-4",children:(0,t.jsx)(eQ,{items:_.filter(e=>"forwarded"===e.status),onView:S,onEdit:A,onProcess:L,onTag:Z,onForward:P,onDelete:T,onSelect:z,selectedItems:g,loading:x})})]})]})}function eQ(e){let{items:s,onView:a,onEdit:i,onProcess:r,onTag:n,onForward:l,onDelete:d,onSelect:c,selectedItems:o,loading:x}=e,u=e=>{switch(e){case"received":return(0,t.jsx)(q.Z,{className:"h-4 w-4 text-blue-500"});case"pending":return(0,t.jsx)(eK.Z,{className:"h-4 w-4 text-yellow-500"});case"processed":return(0,t.jsx)(k.Z,{className:"h-4 w-4 text-green-500"});case"forwarded":return(0,t.jsx)(G.Z,{className:"h-4 w-4 text-purple-500"});default:return(0,t.jsx)(H.Z,{className:"h-4 w-4 text-gray-500"})}};return(0,t.jsx)(h,{children:(0,t.jsxs)(ex,{children:[(0,t.jsx)(eu,{children:(0,t.jsxs)(ep,{children:[(0,t.jsx)(eg,{className:"w-12",children:(0,t.jsx)("input",{type:"checkbox",checked:s.length>0&&s.every(e=>o.includes(e.id)),onChange:s.length>0&&s.every(e=>o.includes(e.id))?()=>{s.forEach(e=>{o.includes(e.id)&&c(e.id)})}:()=>{s.forEach(e=>{o.includes(e.id)||c(e.id)})},className:"rounded"})}),(0,t.jsx)(eg,{children:"ID"}),(0,t.jsx)(eg,{children:"User"}),(0,t.jsx)(eg,{children:"Sender"}),(0,t.jsx)(eg,{children:"Subject"}),(0,t.jsx)(eg,{children:"Tag"}),(0,t.jsx)(eg,{children:"Status"}),(0,t.jsx)(eg,{children:"Received"}),(0,t.jsx)(eg,{children:"Actions"})]})}),(0,t.jsx)(ej,{children:s.map(e=>(0,t.jsxs)(ep,{children:[(0,t.jsx)(ef,{children:(0,t.jsx)("input",{type:"checkbox",checked:o.includes(e.id),onChange:()=>c(e.id),className:"rounded"})}),(0,t.jsxs)(ef,{children:["#",e.id]}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.userName}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ID: ",e.userId]})]})}),(0,t.jsx)(ef,{children:e.sender}),(0,t.jsx)(ef,{children:e.subject}),(0,t.jsx)(ef,{children:(0,t.jsx)(ee,{variant:"outline",children:e.tag})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[u(e.status),(0,t.jsx)(ee,{variant:"outline",className:"capitalize",children:e.status})]})}),(0,t.jsx)(ef,{className:"text-muted-foreground",children:e.received}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>a(e.id),children:(0,t.jsx)(A.Z,{className:"h-4 w-4"})}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>i(e.id),children:(0,t.jsx)(eT.Z,{className:"h-4 w-4"})}),"received"===e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>r(e.id),disabled:x,children:(0,t.jsx)(k.Z,{className:"h-4 w-4"})}),"processed"===e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>l(e.id),disabled:x,children:(0,t.jsx)(G.Z,{className:"h-4 w-4"})}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>d(e.id),disabled:x,children:(0,t.jsx)(eW.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})}var eX=a(4794),e0=a(3276);function e4(e){let{}=e,[s,a]=(0,i.useState)(""),[r,n]=(0,i.useState)("all"),[l,d]=(0,i.useState)("all"),[c,o]=(0,i.useState)(!1),[x,u]=(0,i.useState)([]),{data:g,isLoading:f,refetch:v}=E("/api/admin/forwarding-requests"),{data:N,isLoading:y}=E("/api/admin/forwarding-requests/stats"),w=(g||[{id:1001,userId:1,userName:"Jane Doe",mailItemId:101,mailSubject:"Tax Notice",destination:"123 Business St, London, SW1A 1AA",status:"processing",priority:"standard",trackingNumber:"FR-2847",carrier:"Royal Mail",estimatedDelivery:"2024-01-15",cost:"\xa312.99",createdAt:"2024-01-10",updatedAt:"2024-01-12"},{id:1002,userId:2,userName:"John Smith",mailItemId:102,mailSubject:"Account Statement",destination:"456 High St, Manchester, M1 1AA",status:"shipped",priority:"express",trackingNumber:"FR-2848",carrier:"DPD",estimatedDelivery:"2024-01-14",cost:"\xa318.99",createdAt:"2024-01-09",updatedAt:"2024-01-13"},{id:1003,userId:3,userName:"Alice Johnson",mailItemId:103,mailSubject:"Delivery Notification",destination:"789 Corporate Ave, Birmingham, B1 1AA",status:"delivered",priority:"urgent",trackingNumber:"FR-2849",carrier:"UPS",estimatedDelivery:"2024-01-12",actualDelivery:"2024-01-12",cost:"\xa324.99",createdAt:"2024-01-08",updatedAt:"2024-01-12"}]).filter(e=>{let a=e.userName.toLowerCase().includes(s.toLowerCase())||e.mailSubject.toLowerCase().includes(s.toLowerCase())||e.destination.toLowerCase().includes(s.toLowerCase())||e.trackingNumber&&e.trackingNumber.toLowerCase().includes(s.toLowerCase()),t="all"===r||e.status===r,i="all"===l||e.priority===l;return a&&t&&i}),b=async()=>{o(!0);try{await R("admin_forwarding_refresh"),await v()}catch(e){await R("admin_forwarding_refresh_error",{error:e.message})}finally{o(!1)}},_=async e=>{try{await R("admin_view_forwarding_request",{requestId:e}),window.open("/admin/forwarding/".concat(e),"_blank")}catch(s){await R("admin_view_forwarding_request_error",{requestId:e,error:s.message})}},C=async e=>{try{await R("admin_edit_forwarding_request",{requestId:e}),window.open("/admin/forwarding/".concat(e,"/edit"),"_blank")}catch(s){await R("admin_edit_forwarding_request_error",{requestId:e,error:s.message})}},S=async e=>{o(!0);try{await R("admin_process_forwarding_request",{requestId:e}),await I.post("/api/admin/forwarding-requests/".concat(e,"/process")),v()}catch(s){await R("admin_process_forwarding_request_error",{requestId:e,error:s.message})}finally{o(!1)}},Z=async e=>{o(!0);try{await R("admin_ship_forwarding_request",{requestId:e}),await I.post("/api/admin/forwarding-requests/".concat(e,"/ship")),v()}catch(s){await R("admin_ship_forwarding_request_error",{requestId:e,error:s.message})}finally{o(!1)}},P=async e=>{o(!0);try{await R("admin_cancel_forwarding_request",{requestId:e}),await I.post("/api/admin/forwarding-requests/".concat(e,"/cancel")),v()}catch(s){await R("admin_cancel_forwarding_request_error",{requestId:e,error:s.message})}finally{o(!1)}},T=async e=>{if(0!==x.length){o(!0);try{await R("admin_bulk_forwarding_action",{action:e,requestIds:x}),await I.post("/api/admin/forwarding-requests/bulk/".concat(e),{requestIds:x}),u([]),v()}catch(s){await R("admin_bulk_forwarding_action_error",{action:e,requestIds:x,error:s.message})}finally{o(!1)}}},F=async()=>{o(!0);try{await R("admin_export_forwarding_requests",{filters:{statusFilter:r,priorityFilter:l,searchTerm:s}});let e=await I.get("/api/admin/forwarding-requests/export",{params:{status:r,priority:l,search:s}}),a=new Blob([e.data],{type:"application/json"}),t=window.URL.createObjectURL(a),i=document.createElement("a");i.href=t,i.download="forwarding-requests-export-".concat(new Date().toISOString().split("T")[0],".json"),i.click()}catch(e){await R("admin_export_forwarding_requests_error",{error:e.message})}finally{o(!1)}},U=e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},z=()=>{u([])},D=e=>{switch(e){case"pending":return(0,t.jsx)(eK.Z,{className:"h-4 w-4 text-yellow-500"});case"processing":return(0,t.jsx)(eX.Z,{className:"h-4 w-4 text-blue-500"});case"shipped":return(0,t.jsx)(G.Z,{className:"h-4 w-4 text-purple-500"});case"delivered":return(0,t.jsx)(k.Z,{className:"h-4 w-4 text-green-500"});case"cancelled":return(0,t.jsx)(el.Z,{className:"h-4 w-4 text-red-500"});default:return(0,t.jsx)(H.Z,{className:"h-4 w-4 text-gray-500"})}},M=e=>{switch(e){case"urgent":return"bg-red-100 text-red-800";case"express":return"bg-yellow-100 text-yellow-800";case"standard":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Forwarding Management"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Track and manage mail forwarding requests"}),N&&(0,t.jsxs)("div",{className:"flex gap-4 mt-2 text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Total: ",N.total]}),(0,t.jsxs)("span",{children:["Pending: ",N.pending]}),(0,t.jsxs)("span",{children:["Processing: ",N.processing]}),(0,t.jsxs)("span",{children:["Shipped: ",N.shipped]}),(0,t.jsxs)("span",{children:["Delivered: ",N.delivered]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:F,disabled:c,children:[(0,t.jsx)(W.Z,{className:"h-4 w-4"}),"Export"]}),(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:b,disabled:c,children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 ".concat(c?"animate-spin":"")}),"Refresh"]})]})]}),x.length>0&&(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[x.length," requests selected"]}),(0,t.jsx)(m,{variant:"ghost",size:"sm",onClick:z,children:"Clear"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>T("process"),disabled:c,children:[(0,t.jsx)(e0.Z,{className:"h-4 w-4"}),"Process"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>T("ship"),disabled:c,children:[(0,t.jsx)(G.Z,{className:"h-4 w-4"}),"Ship"]}),(0,t.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>T("cancel"),disabled:c,children:[(0,t.jsx)(el.Z,{className:"h-4 w-4"}),"Cancel"]})]})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eI.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(p,{placeholder:"Search forwarding requests...",value:s,onChange:e=>a(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(eb,{value:r,onValueChange:n,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"Status"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All Status"}),(0,t.jsx)(eL,{value:"pending",children:"Pending"}),(0,t.jsx)(eL,{value:"processing",children:"Processing"}),(0,t.jsx)(eL,{value:"shipped",children:"Shipped"}),(0,t.jsx)(eL,{value:"delivered",children:"Delivered"}),(0,t.jsx)(eL,{value:"cancelled",children:"Cancelled"})]})]}),(0,t.jsxs)(eb,{value:l,onValueChange:d,children:[(0,t.jsx)(ek,{className:"w-[140px]",children:(0,t.jsx)(e_,{placeholder:"Priority"})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"all",children:"All Priority"}),(0,t.jsx)(eL,{value:"standard",children:"Standard"}),(0,t.jsx)(eL,{value:"express",children:"Express"}),(0,t.jsx)(eL,{value:"urgent",children:"Urgent"})]})]})]})]})})}),(0,t.jsx)(h,{children:(0,t.jsxs)(ex,{children:[(0,t.jsx)(eu,{children:(0,t.jsxs)(ep,{children:[(0,t.jsx)(eg,{className:"w-12",children:(0,t.jsx)("input",{type:"checkbox",checked:w.length>0&&w.every(e=>x.includes(e.id)),onChange:w.length>0&&w.every(e=>x.includes(e.id))?z:()=>{u(w.map(e=>e.id))},className:"rounded"})}),(0,t.jsx)(eg,{children:"ID"}),(0,t.jsx)(eg,{children:"User"}),(0,t.jsx)(eg,{children:"Mail Item"}),(0,t.jsx)(eg,{children:"Destination"}),(0,t.jsx)(eg,{children:"Priority"}),(0,t.jsx)(eg,{children:"Status"}),(0,t.jsx)(eg,{children:"Tracking"}),(0,t.jsx)(eg,{children:"Cost"}),(0,t.jsx)(eg,{children:"Created"}),(0,t.jsx)(eg,{children:"Actions"})]})}),(0,t.jsx)(ej,{children:w.map(e=>(0,t.jsxs)(ep,{children:[(0,t.jsx)(ef,{children:(0,t.jsx)("input",{type:"checkbox",checked:x.includes(e.id),onChange:()=>U(e.id),className:"rounded"})}),(0,t.jsxs)(ef,{children:["#",e.id]}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.userName}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ID: ",e.userId]})]})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:["#",e.mailItemId]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.mailSubject})]})}),(0,t.jsx)(ef,{children:(0,t.jsx)("div",{className:"max-w-xs",children:(0,t.jsx)("div",{className:"text-sm font-medium",children:e.destination})})}),(0,t.jsx)(ef,{children:(0,t.jsx)(ee,{className:M(e.priority),variant:"secondary",children:e.priority})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[D(e.status),(0,t.jsx)(ee,{variant:"outline",className:"capitalize",children:e.status})]})}),(0,t.jsx)(ef,{children:e.trackingNumber?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:e.trackingNumber}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.carrier})]}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(ef,{children:e.cost}),(0,t.jsx)(ef,{className:"text-sm text-muted-foreground",children:e.createdAt}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>_(e.id),children:(0,t.jsx)(A.Z,{className:"h-4 w-4"})}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>C(e.id),children:(0,t.jsx)(eT.Z,{className:"h-4 w-4"})}),"pending"===e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>S(e.id),disabled:c,children:(0,t.jsx)(e0.Z,{className:"h-4 w-4"})}),"processing"===e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>Z(e.id),disabled:c,children:(0,t.jsx)(G.Z,{className:"h-4 w-4"})}),"delivered"!==e.status&&"cancelled"!==e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>P(e.id),disabled:c,children:(0,t.jsx)(el.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})]})}var e2=a(8736),e1=a(3085),e5=a(1621);function e3(e){let{}=e,[s,a]=(0,i.useState)(!1),[r,n]=(0,i.useState)("30d"),{data:l,isLoading:d,refetch:c}=E("/api/admin/billing"),{data:o,isLoading:p,refetch:g}=E("/api/admin/transactions"),{data:f,isLoading:v,refetch:N}=E("/api/admin/invoices"),y=l||{monthlyRevenue:47329,outstandingInvoices:2847,churnRate:2.3,revenueGrowth:8.1,churnChange:-.5,pendingPayments:12},w=async()=>{a(!0);try{await R("admin_billing_refresh"),await Promise.all([c(),g(),N()])}catch(e){await R("admin_billing_refresh_error",{error:e.message})}finally{a(!1)}},b=async()=>{a(!0);try{await R("admin_export_billing_reports",{timeRange:r});let e=await I.get("/api/admin/billing/export",{params:{timeRange:r}}),s=new Blob([e.data],{type:"application/json"}),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="billing-report-".concat(r,"-").concat(new Date().toISOString().split("T")[0],".json"),t.click()}catch(e){await R("admin_export_billing_reports_error",{error:e.message})}finally{a(!1)}},C=async e=>{try{await R("admin_view_invoice",{invoiceId:e}),window.open("/admin/invoices/".concat(e),"_blank")}catch(s){await R("admin_view_invoice_error",{invoiceId:e,error:s.message})}},S=async e=>{a(!0);try{await R("admin_process_payment",{transactionId:e}),await I.post("/api/admin/transactions/".concat(e,"/process")),g()}catch(s){await R("admin_process_payment_error",{transactionId:e,error:s.message})}finally{a(!1)}},A=async e=>{a(!0);try{await R("admin_refund_transaction",{transactionId:e}),await I.post("/api/admin/transactions/".concat(e,"/refund")),g()}catch(s){await R("admin_refund_transaction_error",{transactionId:e,error:s.message})}finally{a(!1)}},Z=e=>{switch(e){case"completed":return(0,t.jsx)(k.Z,{className:"h-4 w-4 text-green-500"});case"pending":return(0,t.jsx)(eK.Z,{className:"h-4 w-4 text-yellow-500"});case"failed":return(0,t.jsx)(_.Z,{className:"h-4 w-4 text-red-500"});case"refunded":return(0,t.jsx)(L.Z,{className:"h-4 w-4 text-blue-500"});default:return(0,t.jsx)(eK.Z,{className:"h-4 w-4 text-gray-500"})}},P=e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";case"refunded":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},T=e=>{switch(e){case"subscription":return"bg-purple-100 text-purple-800";case"one_time":return"bg-blue-100 text-blue-800";case"refund":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Billing & Revenue"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Monitor payments, invoices, and revenue metrics"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(eb,{value:r,onValueChange:n,children:[(0,t.jsx)(ek,{className:"w-[120px]",children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"7d",children:"Last 7 days"}),(0,t.jsx)(eL,{value:"30d",children:"Last 30 days"}),(0,t.jsx)(eL,{value:"90d",children:"Last 90 days"}),(0,t.jsx)(eL,{value:"1y",children:"Last year"})]})]}),(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:b,disabled:s,children:[(0,t.jsx)(W.Z,{className:"h-4 w-4"}),"Export Reports"]}),(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:w,disabled:s,children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 ".concat(s?"animate-spin":"")}),"Refresh"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Monthly Revenue"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:["\xa3",y.monthlyRevenue.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,t.jsx)(et.Z,{className:"h-3 w-3"}),"+",y.revenueGrowth,"% from last month"]})]}),(0,t.jsx)(ea.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Outstanding Invoices"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:["\xa3",y.outstandingInvoices.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-xs text-orange-600",children:[y.pendingPayments," pending payments"]})]}),(0,t.jsx)(e2.Z,{className:"h-8 w-8 text-orange-500"})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Churn Rate"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[y.churnRate,"%"]}),(0,t.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,t.jsx)(ei.Z,{className:"h-3 w-3"}),y.churnChange,"% from last month"]})]}),(0,t.jsx)(e1.Z,{className:"h-8 w-8 text-red-500"})]})})})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"Recent Transactions"})}),(0,t.jsx)(j,{children:(0,t.jsxs)(ex,{children:[(0,t.jsx)(eu,{children:(0,t.jsxs)(ep,{children:[(0,t.jsx)(eg,{children:"ID"}),(0,t.jsx)(eg,{children:"User"}),(0,t.jsx)(eg,{children:"Type"}),(0,t.jsx)(eg,{children:"Amount"}),(0,t.jsx)(eg,{children:"Status"}),(0,t.jsx)(eg,{children:"Description"}),(0,t.jsx)(eg,{children:"Payment Method"}),(0,t.jsx)(eg,{children:"Created"}),(0,t.jsx)(eg,{children:"Actions"})]})}),(0,t.jsx)(ej,{children:(o||[{id:2001,userId:1,userName:"Jane Doe",type:"subscription",amount:39.99,currency:"GBP",status:"completed",description:"Premium Plan - Monthly",createdAt:"2024-01-12",invoiceId:"INV-1045",paymentMethod:"Card ending in 4242"},{id:2002,userId:2,userName:"John Smith",type:"subscription",amount:19.99,currency:"GBP",status:"pending",description:"Basic Plan - Monthly",createdAt:"2024-01-11",invoiceId:"INV-1046",paymentMethod:"Card ending in 1234"},{id:2003,userId:3,userName:"Alice Johnson",type:"one_time",amount:24.99,currency:"GBP",status:"completed",description:"Express Forwarding Fee",createdAt:"2024-01-10",paymentMethod:"Card ending in 5678"}]).map(e=>(0,t.jsxs)(ep,{children:[(0,t.jsxs)(ef,{children:["#",e.id]}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.userName}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ID: ",e.userId]})]})}),(0,t.jsx)(ef,{children:(0,t.jsx)(ee,{className:T(e.type),variant:"secondary",children:e.type})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"font-medium",children:[e.currency," ",e.amount.toFixed(2)]})}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[Z(e.status),(0,t.jsx)(ee,{className:P(e.status),variant:"secondary",children:e.status})]})}),(0,t.jsx)(ef,{children:e.description}),(0,t.jsx)(ef,{className:"text-sm text-muted-foreground",children:e.paymentMethod}),(0,t.jsx)(ef,{className:"text-sm text-muted-foreground",children:e.createdAt}),(0,t.jsx)(ef,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.invoiceId&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>C(e.invoiceId),children:(0,t.jsx)(e5.Z,{className:"h-4 w-4"})}),"pending"===e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>S(e.id),disabled:s,children:(0,t.jsx)(k.Z,{className:"h-4 w-4"})}),"completed"===e.status&&(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>A(e.id),disabled:s,children:(0,t.jsx)(L.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"Revenue Trends"})}),(0,t.jsx)(j,{className:"h-64 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(ea.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Revenue trends chart would be displayed here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Integration with charting library (Chart.js, Recharts, etc.)"})]})})]})]})}var e6=a(525);function e9(e){let{}=e,[s,a]=(0,i.useState)(!1),[r,n]=(0,i.useState)("30d"),[l,d]=(0,i.useState)("overview"),{data:c,isLoading:o,refetch:p}=E("/api/admin/analytics"),{data:g,isLoading:f}=E("/api/admin/analytics/users"),{data:v,isLoading:N}=E("/api/admin/analytics/revenue"),{data:y,isLoading:w}=E("/api/admin/analytics/mail"),b=c||{userGrowth:{total:2847,growth:12.3,newUsers:156,activeUsers:2634},revenue:{total:47329,growth:8.1,monthly:47329,yearly:567948},mailVolume:{total:18492,growth:23.4,monthly:18492,processed:18234},planDistribution:{basic:45,premium:35,professional:20}},_=async()=>{a(!0);try{await R("admin_analytics_refresh",{timeRange:r}),await p()}catch(e){await R("admin_analytics_refresh_error",{error:e instanceof Error?e.message:String(e)})}finally{a(!1)}},k=async()=>{a(!0);try{await R("admin_export_analytics",{timeRange:r,metric:l});let e=await I.get("/api/admin/analytics/export?timeRange=".concat(r,"&metric=").concat(l)),s=new Blob([JSON.stringify(e)],{type:"application/json"}),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="analytics-".concat(l,"-").concat(r,"-").concat(new Date().toISOString().split("T")[0],".json"),t.click()}catch(e){await R("admin_export_analytics_error",{error:e instanceof Error?e.message:String(e)})}finally{a(!1)}},C=async e=>{a(!0);try{await R("admin_generate_report",{reportType:e,timeRange:r});let s=await I.post("/api/admin/analytics/reports",{reportType:e,timeRange:r,format:"pdf"}),a=new Blob([s],{type:"application/pdf"}),t=window.URL.createObjectURL(a),i=document.createElement("a");i.href=t,i.download="".concat(e,"-report-").concat(r,"-").concat(new Date().toISOString().split("T")[0],".pdf"),i.click()}catch(s){await R("admin_generate_report_error",{reportType:e,timeRange:r,error:s instanceof Error?s.message:String(s)})}finally{a(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Detailed insights and performance metrics"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(eb,{value:r,onValueChange:n,children:[(0,t.jsx)(ek,{className:"w-[120px]",children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"7d",children:"Last 7 days"}),(0,t.jsx)(eL,{value:"30d",children:"Last 30 days"}),(0,t.jsx)(eL,{value:"90d",children:"Last 90 days"}),(0,t.jsx)(eL,{value:"1y",children:"Last year"})]})]}),(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:k,disabled:s,children:[(0,t.jsx)(W.Z,{className:"h-4 w-4"}),"Export"]}),(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:_,disabled:s,children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 ".concat(s?"animate-spin":"")}),"Refresh"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:b.userGrowth.total.toLocaleString()}),(0,t.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,t.jsx)(e6.Z,{className:"h-3 w-3"}),"+",b.userGrowth.growth,"% growth"]})]}),(0,t.jsx)(V.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Monthly Revenue"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:["\xa3",b.revenue.monthly.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,t.jsx)(e6.Z,{className:"h-3 w-3"}),"+",b.revenue.growth,"% growth"]})]}),(0,t.jsx)(ea.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Mail Processed"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:b.mailVolume.monthly.toLocaleString()}),(0,t.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,t.jsx)(e6.Z,{className:"h-3 w-3"}),"+",b.mailVolume.growth,"% growth"]})]}),(0,t.jsx)(q.Z,{className:"h-8 w-8 text-purple-500"})]})})}),(0,t.jsx)(h,{children:(0,t.jsx)(j,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Active Users"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:b.userGrowth.activeUsers.toLocaleString()}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(b.userGrowth.activeUsers/b.userGrowth.total*100).toFixed(1),"% of total"]})]}),(0,t.jsx)(en.Z,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(h,{children:[(0,t.jsxs)(x,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(u,{children:"User Growth"}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>C("user-growth"),disabled:s,children:(0,t.jsx)(W.Z,{className:"h-4 w-4"})})]}),(0,t.jsx)(j,{className:"h-64 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(M.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"User growth chart would be displayed here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Shows new registrations, activations, and churn over time"})]})})]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(x,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(u,{children:"Revenue Trends"}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>C("revenue-trends"),disabled:s,children:(0,t.jsx)(W.Z,{className:"h-4 w-4"})})]}),(0,t.jsx)(j,{className:"h-64 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(e6.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Revenue trends chart would be displayed here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Shows monthly recurring revenue, one-time payments, and refunds"})]})})]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(x,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(u,{children:"Mail Volume"}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>C("mail-volume"),disabled:s,children:(0,t.jsx)(W.Z,{className:"h-4 w-4"})})]}),(0,t.jsx)(j,{className:"h-64 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(q.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Mail volume chart would be displayed here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Shows incoming mail, processing times, and forwarding volumes"})]})})]}),(0,t.jsxs)(h,{children:[(0,t.jsxs)(x,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(u,{children:"Plan Distribution"}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>C("plan-distribution"),disabled:s,children:(0,t.jsx)(W.Z,{className:"h-4 w-4"})})]}),(0,t.jsx)(j,{className:"h-64 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(B.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Plan distribution chart would be displayed here"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:["Shows breakdown of Basic (",b.planDistribution.basic,"%), Premium (",b.planDistribution.premium,"%), and Professional (",b.planDistribution.professional,"%) plans"]})]})})]})]}),(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"Detailed Metrics"})}),(0,t.jsx)(j,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"User Metrics"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-muted-foreground",children:["New Users (",r,")"]}),(0,t.jsx)("span",{className:"font-medium",children:b.userGrowth.newUsers})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Active Users"}),(0,t.jsx)("span",{className:"font-medium",children:b.userGrowth.activeUsers})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Growth Rate"}),(0,t.jsxs)("span",{className:"font-medium text-green-600",children:["+",b.userGrowth.growth,"%"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Revenue Metrics"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Monthly Revenue"}),(0,t.jsxs)("span",{className:"font-medium",children:["\xa3",b.revenue.monthly.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Yearly Revenue"}),(0,t.jsxs)("span",{className:"font-medium",children:["\xa3",b.revenue.yearly.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Growth Rate"}),(0,t.jsxs)("span",{className:"font-medium text-green-600",children:["+",b.revenue.growth,"%"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Mail Metrics"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Total Processed"}),(0,t.jsx)("span",{className:"font-medium",children:b.mailVolume.processed.toLocaleString()})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Monthly Volume"}),(0,t.jsx)("span",{className:"font-medium",children:b.mailVolume.monthly.toLocaleString()})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Growth Rate"}),(0,t.jsxs)("span",{className:"font-medium text-green-600",children:["+",b.mailVolume.growth,"%"]})]})]})]})]})})]})]})}var e8=a(721);let e7=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(e8.fC,{className:c("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...i,ref:s,children:(0,t.jsx)(e8.bU,{className:c("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});e7.displayName=e8.fC.displayName;var se=a(91),ss=a(6137),sa=a(4001);function st(e){let{}=e,[s,a]=(0,i.useState)(!1),[r,n]=(0,i.useState)(!1),[l,d]=(0,i.useState)({general:{siteName:"VirtualAddressHub",siteUrl:"https://virtualaddresshub.com",adminEmail:"admin@virtualaddresshub.com",timezone:"Europe/London",maintenanceMode:!1},notifications:{emailNotifications:!0,smsNotifications:!1,pushNotifications:!0,adminAlerts:!0,userAlerts:!0},integrations:{mailProvider:"royal_mail",paymentProvider:"stripe",kycProvider:"sumsub",analyticsProvider:"google_analytics",emailProvider:"postmark"},security:{twoFactorAuth:!0,sessionTimeout:30,passwordPolicy:"strong",ipWhitelist:[],auditLogging:!0}}),{data:c,isLoading:o,refetch:g}=E("/api/admin/settings"),{data:f,isLoading:N}=E("/api/admin/system/health");(0,i.useEffect)(()=>{c&&d(c)},[c]);let y=async()=>{a(!0);try{await R("admin_settings_refresh"),await g()}catch(e){await R("admin_settings_refresh_error",{error:e.message})}finally{a(!1)}},w=async e=>{n(!0);try{await R("admin_save_settings",{section:e,settings:l[e]}),await I.post("/api/admin/settings/".concat(e),l[e]),await g()}catch(s){await R("admin_save_settings_error",{section:e,error:s.message})}finally{n(!1)}},b=async e=>{a(!0);try{await R("admin_test_integration",{integration:e}),await I.post("/api/admin/integrations/".concat(e,"/test"))}catch(s){await R("admin_test_integration_error",{integration:e,error:s.message})}finally{a(!1)}},_=async()=>{a(!0);try{await R("admin_backup_database");let e=await I.post("/api/admin/database/backup"),s=new Blob([e.data],{type:"application/sql"}),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="database-backup-".concat(new Date().toISOString().split("T")[0],".sql"),t.click()}catch(e){await R("admin_backup_database_error",{error:e.message})}finally{a(!1)}},k=async()=>{a(!0);try{await R("admin_clear_cache"),await I.post("/api/admin/cache/clear")}catch(e){await R("admin_clear_cache_error",{error:e.message})}finally{a(!1)}},C=(e,s,a)=>{d(t=>({...t,[e]:{...t[e],[s]:a}}))};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"System Settings"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Configure system-wide settings and preferences"})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(m,{variant:"outline",className:"gap-2",onClick:y,disabled:s,children:[(0,t.jsx)(L.Z,{className:"h-4 w-4 ".concat(s?"animate-spin":"")}),"Refresh"]})})]}),(0,t.jsxs)(eU,{defaultValue:"general",className:"space-y-4",children:[(0,t.jsxs)(ez,{children:[(0,t.jsx)(eE,{value:"general",children:"General"}),(0,t.jsx)(eE,{value:"notifications",children:"Notifications"}),(0,t.jsx)(eE,{value:"integrations",children:"Integrations"}),(0,t.jsx)(eE,{value:"security",children:"Security"}),(0,t.jsx)(eE,{value:"maintenance",children:"Maintenance"})]}),(0,t.jsx)(eD,{value:"general",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"General Settings"})}),(0,t.jsxs)(j,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"siteName",children:"Site Name"}),(0,t.jsx)(p,{id:"siteName",value:l.general.siteName,onChange:e=>C("general","siteName",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"siteUrl",children:"Site URL"}),(0,t.jsx)(p,{id:"siteUrl",value:l.general.siteUrl,onChange:e=>C("general","siteUrl",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"adminEmail",children:"Admin Email"}),(0,t.jsx)(p,{id:"adminEmail",type:"email",value:l.general.adminEmail,onChange:e=>C("general","adminEmail",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"timezone",children:"Timezone"}),(0,t.jsxs)(eb,{value:l.general.timezone,onValueChange:e=>C("general","timezone",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"Europe/London",children:"Europe/London"}),(0,t.jsx)(eL,{value:"America/New_York",children:"America/New_York"}),(0,t.jsx)(eL,{value:"America/Los_Angeles",children:"America/Los_Angeles"}),(0,t.jsx)(eL,{value:"Asia/Tokyo",children:"Asia/Tokyo"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(e7,{id:"maintenanceMode",checked:l.general.maintenanceMode,onCheckedChange:e=>C("general","maintenanceMode",e)}),(0,t.jsx)(v,{htmlFor:"maintenanceMode",children:"Maintenance Mode"})]}),(0,t.jsxs)(m,{onClick:()=>w("general"),disabled:r,children:[(0,t.jsx)(eO.Z,{className:"h-4 w-4 mr-2"}),"Save General Settings"]})]})]})}),(0,t.jsx)(eD,{value:"notifications",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"Notification Settings"})}),(0,t.jsxs)(j,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"Email Notifications"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Send email notifications to users"})]}),(0,t.jsx)(e7,{checked:l.notifications.emailNotifications,onCheckedChange:e=>C("notifications","emailNotifications",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"SMS Notifications"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Send SMS notifications to users"})]}),(0,t.jsx)(e7,{checked:l.notifications.smsNotifications,onCheckedChange:e=>C("notifications","smsNotifications",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"Push Notifications"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Send push notifications to users"})]}),(0,t.jsx)(e7,{checked:l.notifications.pushNotifications,onCheckedChange:e=>C("notifications","pushNotifications",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"Admin Alerts"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Send alerts to admin users"})]}),(0,t.jsx)(e7,{checked:l.notifications.adminAlerts,onCheckedChange:e=>C("notifications","adminAlerts",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"User Alerts"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Send alerts to regular users"})]}),(0,t.jsx)(e7,{checked:l.notifications.userAlerts,onCheckedChange:e=>C("notifications","userAlerts",e)})]})]}),(0,t.jsxs)(m,{onClick:()=>w("notifications"),disabled:r,children:[(0,t.jsx)(eO.Z,{className:"h-4 w-4 mr-2"}),"Save Notification Settings"]})]})]})}),(0,t.jsx)(eD,{value:"integrations",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"Third-party Integrations"})}),(0,t.jsxs)(j,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{children:"Mail Provider"}),(0,t.jsxs)(eb,{value:l.integrations.mailProvider,onValueChange:e=>C("integrations","mailProvider",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"royal_mail",children:"Royal Mail"}),(0,t.jsx)(eL,{value:"dpd",children:"DPD"}),(0,t.jsx)(eL,{value:"ups",children:"UPS"}),(0,t.jsx)(eL,{value:"fedex",children:"FedEx"})]})]}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>b("mail"),children:"Test Connection"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{children:"Payment Provider"}),(0,t.jsxs)(eb,{value:l.integrations.paymentProvider,onValueChange:e=>C("integrations","paymentProvider",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"stripe",children:"Stripe"}),(0,t.jsx)(eL,{value:"paypal",children:"PayPal"}),(0,t.jsx)(eL,{value:"gocardless",children:"GoCardless"})]})]}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>b("payment"),children:"Test Connection"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{children:"KYC Provider"}),(0,t.jsxs)(eb,{value:l.integrations.kycProvider,onValueChange:e=>C("integrations","kycProvider",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"sumsub",children:"Sumsub"}),(0,t.jsx)(eL,{value:"jumio",children:"Jumio"}),(0,t.jsx)(eL,{value:"onfido",children:"Onfido"})]})]}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>b("kyc"),children:"Test Connection"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{children:"Email Provider"}),(0,t.jsxs)(eb,{value:l.integrations.emailProvider,onValueChange:e=>C("integrations","emailProvider",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"postmark",children:"Postmark"}),(0,t.jsx)(eL,{value:"sendgrid",children:"SendGrid"}),(0,t.jsx)(eL,{value:"mailgun",children:"Mailgun"})]})]}),(0,t.jsx)(m,{size:"sm",variant:"outline",onClick:()=>b("email"),children:"Test Connection"})]})]}),(0,t.jsxs)(m,{onClick:()=>w("integrations"),disabled:r,children:[(0,t.jsx)(eO.Z,{className:"h-4 w-4 mr-2"}),"Save Integration Settings"]})]})]})}),(0,t.jsx)(eD,{value:"security",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"Security Settings"})}),(0,t.jsxs)(j,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"Two-Factor Authentication"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Require 2FA for admin users"})]}),(0,t.jsx)(e7,{checked:l.security.twoFactorAuth,onCheckedChange:e=>C("security","twoFactorAuth",e)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{htmlFor:"sessionTimeout",children:"Session Timeout (minutes)"}),(0,t.jsx)(p,{id:"sessionTimeout",type:"number",value:l.security.sessionTimeout,onChange:e=>C("security","sessionTimeout",parseInt(e.target.value))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{children:"Password Policy"}),(0,t.jsxs)(eb,{value:l.security.passwordPolicy,onValueChange:e=>C("security","passwordPolicy",e),children:[(0,t.jsx)(ek,{children:(0,t.jsx)(e_,{})}),(0,t.jsxs)(eA,{children:[(0,t.jsx)(eL,{value:"basic",children:"Basic"}),(0,t.jsx)(eL,{value:"strong",children:"Strong"}),(0,t.jsx)(eL,{value:"very_strong",children:"Very Strong"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(v,{children:"Audit Logging"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Log all admin actions"})]}),(0,t.jsx)(e7,{checked:l.security.auditLogging,onCheckedChange:e=>C("security","auditLogging",e)})]})]}),(0,t.jsxs)(m,{onClick:()=>w("security"),disabled:r,children:[(0,t.jsx)(eO.Z,{className:"h-4 w-4 mr-2"}),"Save Security Settings"]})]})]})}),(0,t.jsx)(eD,{value:"maintenance",className:"space-y-4",children:(0,t.jsxs)(h,{children:[(0,t.jsx)(x,{children:(0,t.jsx)(u,{children:"System Maintenance"})}),(0,t.jsxs)(j,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Database Operations"}),(0,t.jsxs)(m,{variant:"outline",className:"w-full gap-2",onClick:_,disabled:s,children:[(0,t.jsx)(se.Z,{className:"h-4 w-4"}),"Backup Database"]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Cache Operations"}),(0,t.jsxs)(m,{variant:"outline",className:"w-full gap-2",onClick:k,disabled:s,children:[(0,t.jsx)(L.Z,{className:"h-4 w-4"}),"Clear Cache"]})]})]}),f&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"System Health"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ss.Z,{className:"h-4 w-4 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm",children:["Database: ",f.database?"Healthy":"Unhealthy"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(sa.Z,{className:"h-4 w-4 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm",children:["API Keys: ",f.apiKeys?"Valid":"Invalid"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(V.Z,{className:"h-4 w-4 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm",children:["Users: ",f.users]})]})]})]})]})]})})]})]})}function si(e){let{onLogout:s,onNavigate:a,onGoBack:r}=e,[n,l]=(0,i.useState)("overview"),[d,c]=(0,i.useState)(!1),[o,h]=(0,i.useState)(!1),[x,u]=(0,i.useState)(null),j=[{id:"overview",label:"Overview",icon:(0,t.jsx)(M.Z,{className:"h-4 w-4"})},{id:"users",label:"Users",icon:(0,t.jsx)(V.Z,{className:"h-4 w-4"})},{id:"mail",label:"Mail",icon:(0,t.jsx)(q.Z,{className:"h-4 w-4"})},{id:"forwarding",label:"Forwarding",icon:(0,t.jsx)(G.Z,{className:"h-4 w-4"})},{id:"billing",label:"Billing",icon:(0,t.jsx)(O.Z,{className:"h-4 w-4"})},{id:"analytics",label:"Analytics",icon:(0,t.jsx)(B.Z,{className:"h-4 w-4"})},{id:"settings",label:"Settings",icon:(0,t.jsx)(J.Z,{className:"h-4 w-4"})}],p=async()=>{h(!0),u(null);try{await R("admin_dashboard_refresh"),window.location.reload()}catch(e){u("Failed to refresh dashboard"),await R("admin_dashboard_refresh_error",{error:e instanceof Error?e.message:String(e)})}finally{h(!1)}},g=async()=>{h(!0);try{await R("admin_export_data",{section:n});let e=await I.get("/api/admin/export/".concat(n)),s=new Blob([e.data],{type:"application/json"}),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="".concat(n,"-export-").concat(new Date().toISOString().split("T")[0],".json"),t.click()}catch(e){u("Failed to export data"),await R("admin_export_error",{error:e instanceof Error?e.message:String(e)})}finally{h(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[x&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 m-4 rounded-md",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(H.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:x}),(0,t.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>u(null),children:(0,t.jsx)(K.Z,{className:"h-4 w-4"})})]})}),(0,t.jsxs)("header",{className:"bg-card border-b border-border",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between h-14 px-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Q,{size:"sm",showText:!1}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"font-semibold text-sm text-primary",children:"Admin Portal"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground hidden sm:block",children:"VirtualAddressHub"})]})]}),(0,t.jsx)("nav",{className:"hidden lg:flex items-center gap-1",children:j.map(e=>(0,t.jsxs)(m,{variant:n===e.id?"default":"ghost",size:"sm",onClick:()=>l(e.id),className:"gap-1.5 h-8 px-3",children:[e.icon,(0,t.jsx)("span",{className:"text-sm",children:e.label})]},e.id))}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(m,{variant:"ghost",size:"sm",className:"lg:hidden h-8 w-8 p-0",onClick:()=>c(!d),children:d?(0,t.jsx)(K.Z,{className:"h-4 w-4"}):(0,t.jsx)(Y.Z,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"hidden lg:flex items-center gap-1",children:[(0,t.jsx)(m,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:p,disabled:o,children:(0,t.jsx)(L.Z,{className:"h-4 w-4 ".concat(o?"animate-spin":"")})}),(0,t.jsx)(m,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:g,disabled:o,children:(0,t.jsx)(W.Z,{className:"h-4 w-4"})})]}),(0,t.jsxs)(m,{variant:"ghost",size:"sm",onClick:s,className:"h-8 px-2 text-destructive hover:text-destructive hover:bg-destructive/10",children:[(0,t.jsx)($.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline ml-1",children:"Sign out"})]})]})]}),d&&(0,t.jsx)("div",{className:"lg:hidden border-t border-border p-3",children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:j.map(e=>(0,t.jsxs)(m,{variant:n===e.id?"default":"outline",size:"sm",onClick:()=>{l(e.id),c(!1)},className:"justify-start gap-2 h-8 text-xs",children:[e.icon,(0,t.jsx)("span",{className:"truncate",children:e.label})]},e.id))})})]}),(0,t.jsx)("main",{className:"p-4 lg:p-6",children:(()=>{switch(n){case"overview":default:return(0,t.jsx)(ed,{});case"users":return(0,t.jsx)(eH,{onNavigate:a});case"mail":return(0,t.jsx)(e$,{});case"forwarding":return(0,t.jsx)(e4,{});case"billing":return(0,t.jsx)(e3,{});case"analytics":return(0,t.jsx)(e9,{});case"settings":return(0,t.jsx)(st,{})}})()})]})}let sr=(0,i.createContext)(void 0);function sn(e){let{children:s}=e,[a,r]=(0,i.useState)(null),[n,l]=(0,i.useState)(!0),d=(null==a?void 0:a.is_admin)||!1;(0,i.useEffect)(()=>{(async()=>{try{if(F.isAuthenticated()){let e=await F.checkAuth();r(e)}}catch(e){console.error("Auth initialization failed:",e),F.clearAuth()}finally{l(!1)}})()},[]);let c=async e=>{l(!0);try{await U("user_login_attempt",{email:e.email});let s=await I.post("/api/auth/login",e);if(s.ok)F.setToken(s.token),F.setUser(s.user),r(s.user),await U("user_login_success",{email:e.email,userId:s.user.id});else throw Error("Login failed")}catch(s){throw await U("user_login_failed",{email:e.email,error:s.message}),s}finally{l(!1)}},o=async e=>{l(!0);try{var s;await U("admin_login_attempt",{email:e.email});let a=await I.post("/api/auth/login",{...e,isAdmin:!0});if(a.ok&&(null===(s=a.user)||void 0===s?void 0:s.is_admin))F.setToken(a.token),F.setUser(a.user),r(a.user),await U("admin_login_success",{email:e.email,adminId:a.user.id}),await R("admin_login",{email:e.email,adminId:a.user.id});else throw Error("Admin access required")}catch(s){throw await U("admin_login_failed",{email:e.email,error:s.message}),s}finally{l(!1)}},m=async()=>{l(!0);try{(null==a?void 0:a.is_admin)?await R("admin_logout",{adminId:a.id}):await U("user_logout",{userId:null==a?void 0:a.id}),await I.post("/api/auth/logout")}catch(e){console.error("Logout API call failed:",e)}finally{F.clearAuth(),r(null),l(!1)}},h=async()=>{try{let e=await F.checkAuth();r(e)}catch(e){console.error("Failed to refresh user data:",e),F.clearAuth(),r(null)}};return(0,t.jsx)(sr.Provider,{value:{user:a,isAuthenticated:!!a,isAdmin:d,isLoading:n,login:c,adminLogin:o,logout:m,createDemoSession:e=>{let s="admin"===e?{id:"demo-admin",email:"admin@virtualaddresshub.co.uk",name:"Demo Admin",is_admin:!0,role:"super_admin",kyc_status:"approved",plan:"professional"}:{id:"demo-user",email:"demo@virtualaddresshub.co.uk",name:"Demo User",is_admin:!1,role:"user",kyc_status:"approved",plan:"premium"};F.setUser(s),F.setToken("demo-".concat(e,"-token")),r(s),U("".concat(e,"_demo_session_created"),{email:s.email,userId:s.id})},refreshUser:h},children:s})}function sl(){let{isAuthenticated:e,isAdmin:s,logout:a}=function(){let e=(0,i.useContext)(sr);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}(),[r,n]=(0,i.useState)(!1);(0,i.useEffect)(()=>{e&&s?n(!0):n(!1)},[e,s]);let l=async()=>{await a(),n(!1)},d=()=>{window.location.href="/"};return r?(0,t.jsx)(si,{onLogout:l,onNavigate:(e,s)=>{console.log("Navigate to:",e,s)},onGoBack:d}):(0,t.jsx)(D,{onLogin:()=>{n(!0)},onGoBack:d})}function sd(){return(0,t.jsx)(sn,{children:(0,t.jsx)(sl,{})})}}},function(e){e.O(0,[586,971,117,744],function(){return e(e.s=4756)}),_N_E=e.O()}]);